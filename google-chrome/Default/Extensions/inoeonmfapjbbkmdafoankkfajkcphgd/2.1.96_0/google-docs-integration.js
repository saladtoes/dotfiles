(function(){const compiler={};compiler["VERSION"]="2.0.14";'use strict';function x(a,c){var b=void 0;return new (b||(b=Promise))(function(d,e){function f(k){try{h(c.next(k))}catch(l){e(l)}}function g(k){try{h(c["throw"](k))}catch(l){e(l)}}function h(k){k.done?d(k.value):(new b(function(l){l(k.value)})).then(f,g)}h((c=c.apply(a,void 0)).next())})};var aa=class{constructor(a,c){this.h=a;this.type="wizkids-google-docs-inbound";this.g=c}};var y=class{constructor(){this.name="StopPropagation"}};function A(a,...c){var b=Array.from(a.P.entries()).sort(([,d],[,e])=>{var f,g;return(null!==(f=e.priority)&&void 0!==f?f:0)-(null!==(g=d.priority)&&void 0!==g?g:0)});for(const [d,e]of b)if(b=d(...c),e.once&&a.remove(d),b instanceof y&&"StopPropagation"===b.name)return b}var C=class{constructor(){this.P=new Map}add(a,c={}){this.P.has(a)||this.P.set(a,c)}once(a,c={}){this.P.has(a)||this.P.set(a,Object.assign(Object.assign({},c),{once:!0}))}remove(a){this.P.delete(a)}clear(){this.P.clear()}};var D=class{constructor(){this.B=!1;this.i=new C}M(){this.B||(this.B=!0,this.g(),A(this.i),this.i.clear())}g(){}};function ba(a,c){var b=document;a:{for(d of a.h)if(b===d.h&&"wizkids-google-docs-inbound"===d.type&&c===d.g)break a;var d=null}d||(a.h.push(new aa(b,c)),b.addEventListener("wizkids-google-docs-inbound",c,!1))}var ca=class extends D{constructor(){super(...arguments);this.h=[]}g(){super.g();for(const a of this.h)a.h.removeEventListener(a.type,a.g,!1);this.h=[]}};function E(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};function F(a,c){const b=[];var d="",e=0;for(let h=0;h<a.length;h++){var f=a[h];if("["===f){if(0===e){if(""===d)throw Error("Something went wrong. Tried to push property but it was empty @ "+h+" - "+a);b.push(d);d=""}else d+=f;e++}else if("]"===f){e--;if(0>e)throw Error("Something went wrong. Found a closing bracket without a starting bracket @ "+h+" - "+a);if(0===e){f=F(d,c);if("number"!==typeof f&&"string"!==typeof f)throw Error("Something went wrong. The property "+d+" didn't resolve into a number or string! It gave "+
typeof f+" @ "+h+" - "+a);b.push(f);d=""}else d+=f}else if(0<e)d+=f;else if("."===f){if(""===d)throw Error("Something went wrong. Tried to push property but it was empty @ "+h+" - "+a);b.push(d);d=""}else d+=f}if(0!==e)throw Error("Something went wrong. The path ended unexpectedly "+a);0<d.length&&b.push(d);let g;for(a=0;a<b.length;a++)if(e=b[a],0===a)if("string"===typeof e&&e.match(/([0-9]+(\.[0-9]+)?)|\.[0-9]+/))g=e.match(/\./)?parseFloat(e):parseInt(e,10);else if("string"===typeof e)if(e in c)g=
c[e];else throw Error("Unable to find variable `"+e+"` in variables parameter!");else g=e;else"string"===typeof e?(d=e.match(/^([a-zA-Z0-9$_]+)\((.*?)\)$/))?(e=d[2].split(",").map(h=>F(h,c)),g=g[d[1]](...e)):g=g[e]:g=g[e];return g};function J(a){return a===window||a&&a.document&&a.location&&a.alert&&a.setInterval}function da(a){return a===document||a&&"#document"===a.nodeName}
function L(a,c){if(c in a.o)return a.o[c];for(const b in window){const d=window[b];if("function"===typeof d&&"prototype"in d&&"object"===typeof d.prototype&&"constructor"in d.prototype&&"function"===typeof d.prototype.constructor&&"toString"in d.prototype&&"function"===typeof d.prototype.toString&&-1!==d.prototype.toString.toString().indexOf('"'+c+"("))return a.o[c]=d}throw Error("Unable to get selection constructor");}
function ea(a){if(null!==a.B)return a.B;const c=/^function(?: [a-zA-Z0-9$_]+)?\(a,b,c,d\)\{([\w\W]+)\.getSelection\(\);[\w\W]+\.getType\(\)/;for(const b in window){const d=window[b];if("function"!==typeof d)continue;const e=d.toString().match(c);if(e&&!e[1].includes("function(){"))return a.B={key:b,value:d},{key:b,value:d}}throw Error("Unable to get selection setter");}
function fa(a){return(c,b)=>{a:if(null!==a.g)var d=a.g;else{var e=window.KX_kixApp;for(var f in e)try{const l=e[f];if("object"===typeof l)for(const m in l)try{const p=l[m];if(p&&"object"===typeof p&&p["application/x-vnd.google-docs-document-slice-clip+wrapped"]){d=a.g=p;break a}}catch(p){}}catch(l){}d=null}if(!(d&&c in d))return!1;a:{e=d[c];f=Object.keys(e.constructor.prototype);for(g of f)if(f=e[g],"function"===typeof f&&-1!==f.toString().indexOf("getData")){var g=f;break a}g=null}if(!g)return!1;
a:if(null!==a.l)var h=a.l;else{for(h in window)if(e=window[h],"function"===typeof e&&e.toString().match(/^function(?: [a-zA-Z0-9$_]+)?\(a,b\)\{this\.[a-zA-Z0-9$_]+=a;this\.[a-zA-Z0-9$_]+=b;?}$/)&&(f=Object.keys(e.prototype),1===f.length&&"constructor"===f[0])){h=a.l=e;break a}h=null}a:if(null!==a.m)var k=a.m;else{for(k in window)if(e=window[k],"function"===typeof e&&e.toString().match(/^function(?: [a-zA-Z0-9$_]+)?\(a,b\)\{this\.[a-zA-Z0-9$_]+=a;this\.[a-zA-Z0-9$_]+=b;?}$/)&&(f=Object.keys(e.prototype),
f.includes("getData")&&f.includes("getMimeType"))){k=a.m=e;break a}k=null}if(!h||!k)return!1;b=new k(c,b);k=null;(e=g.toString().match(/\.([a-zA-Z0-9$_]+)\.getData\(\);/))&&h.toString().includes(`this.${e[1]}=b`)&&(k=new h(null,b));null===k&&(k=new h(b,null));g.call(d[c],k);return!0}}
function ha(){const a=window.KX_kixApp;for(const b in a){const d=a[b];if(d&&d instanceof Object&&!Array.isArray(d)&&!J(d)&&"function"===typeof d.getId&&"function"===typeof d.getParent&&"function"===typeof d.removeChild&&"function"===typeof d.render&&"function"===typeof d.listen){var c=Object.keys(d).filter(e=>d[e]instanceof HTMLElement).map(e=>d[e]);if(1===c.length&&(c=c[0],c.parentNode&&"BODY"===c.parentNode.tagName))return d}}throw Error("Unable to get equation element");}
function ia(a){const c=window;for(const e in c){var b=c[e];if("function"!==typeof b)continue;b=b.toString();const f=b.indexOf(a+"(");if(-1===f)continue;var d=b.substring(f).match(/^[a-zA-Z0-9$_]+\([a-zA-Z0-9$_]+,([a-zA-Z0-9$_]+),/);if(!d)continue;d=b.substring(0,f).match(new RegExp(`${E(d[1])}=([a-zA-Z0-9$_]+)\\(([a-zA-Z0-9$_]+),([a-zA-Z0-9$_]+)\\)`));if(!d)continue;const g=d[1];b=b.substring(0,f).match(new RegExp(`var ${E(d[3])}=(.*?);`));if(!b)continue;const h=F(`window.${b[1]}`,window);if(h)return k=>
window[g](k,h)}throw Error("Unable to get function");}function ja(){const a=window;for(const c in a){const b=a[c];if("function"!==typeof b)continue;const d=b.toString().match(/^function(?: [a-zA-Z0-9$_]+)?\((a,b(,c)?)\)\{(.*?)\.isVisible(.*?)\.dispatchEvent/);if(d){const e={value:b,ra:b,key:c,parent:a,Ha:f=>{const g=ha(),h=[g];3===d[1].split(",").length&&h.push(ia(c)(g));h.push(f);e.ra.apply(e.parent,h)}};return e}}throw Error("Unable to get function");}
function la(a){if(a.s)return a.s;var {key:c}=ea(a);c=new RegExp(`${E(c)}\\(([^,\\)]+)`);a:if(a.j)var b=a.j;else{var d=document.querySelector(".kix-appview-editor"),e=window.KX_kixApp;for(b in e){const h=e[b];if(h&&h instanceof Object&&!Array.isArray(h)&&!J(h)&&"function"!==typeof h.initialize&&"function"!==typeof h.addEventListener&&"function"!==typeof h.render)for(var f in h)if(h[f]===d&&"function"===typeof h.setActive){b=a.j=h;break a}}throw Error("Unable to get element");}for(d=f=b;d.__proto__;){d=
d.__proto__;for(var g in d)if("function"===typeof d[g]&&(b=d[g].toString().match(c))&&(b=b[1].split("."),!(2>b.length||"this"!==b[0]))){b.shift();for(g=f;void 0!==(c=b.shift());)g=g[c];return a.s=g}}throw Error("Unable to get selection element");}var ma=class{constructor(){this.h=this.i=null;this.o={};this.s=this.j=this.m=this.l=this.g=this.B=null}};var na=class{constructor(){this.type="equation"}};var oa=class{constructor(a){this.type="equation_function";this.g=a}};var M=class{constructor(a){this.type=a}};var N=class extends M{constructor(a){super("InlineLocation");this.G=a}};var O=class extends M{constructor(a){super("PositionedLocation");this.id=a}};var P=class extends M{constructor(a){super("CellBorderLocation");this.g=a}},pa=class{constructor(a,c){this.type=a;this.index=c}};var qa=class extends M{constructor(a){super("ListItemLocation");this.index=a}};var ra=class extends M{constructor(a,c,b){super("ListNestingLevelLocation");this.id=a;this.g=c;this.index=b}};function sa(a){return 10>a?"0"+String(a):a.toString(16)};function ta(a){return(c,b)=>b instanceof HTMLElement?(c=new Uint8Array(20),window.crypto.getRandomValues(c),c=Array.from(c,sa).join(""),b.classList.add(c),a(b,c),"\u0002"+c):"string"===typeof b?"\u0001"+b:b}
function ua(a,c){if("string"!==typeof c)return c;a=c.charAt(0);c=c.substring(1);switch(a){case "\u0001":return c;case "\u0002":a=Array.from(document.getElementsByClassName(c));if(0===a.length)throw Error("Couldn't find element with unique class `"+c+"`!");if(1<a.length)throw Error("Found multiple elements with unique class `"+c+"`!");return a[0];default:throw Error("Unknown identifier in beginning of text \\x"+sa(a));throw void 0;}};function Q(a,c){return(c=a.constructor.toString().match(c))?a[c[1]]:null}const va=new Map;
function wa(a){var c=va.get(a.toString());if(c)return c;c=window;for(var b in c){var d=c[b];if("function"===typeof d){var e=d.toString();if(!e.includes("[native code]")){if(a.test(e))return b={parent:c,key:b,value:d},va.set(a.toString(),b),b;if("prototype"in d){d=d.prototype;for(const f in d)if("error"!==f&&"constructor"!==f&&"lower"!==f&&(e=Object.getOwnPropertyDescriptor(d,f),null!==e&&void 0!==e&&e.value&&(e=d[f],"function"===typeof e&&a.test(e.toString()))))return b={parent:d,key:f,value:e},va.set(a.toString(),
b),b}}}}return null}const xa=new Map;function R(a,c){const b=[];document.dispatchEvent(new CustomEvent("wizkids-google-docs-outbound",{cancelable:!0,bubbles:!0,detail:JSON.stringify({id:a,result:JSON.stringify(c,ta((d,e)=>b.push({element:d,className:e})))},ta((d,e)=>b.push({element:d,className:e})))}));for(const {element:d,className:e}of b)d.classList.remove(e)}
function ya(a,c){const b=[];document.dispatchEvent(new CustomEvent("wizkids-google-docs-outbound",{cancelable:!0,bubbles:!0,detail:JSON.stringify({id:a,error:JSON.stringify({name:c.name,message:c.message,stack:c.stack},ta((d,e)=>b.push({element:d,className:e})))},ta((d,e)=>b.push({element:d,className:e})))}));for(const {element:d,className:e}of b)d.classList.remove(e)}
function za(a,c){for(let b=0;b<a.length;b++){const d=a[b];for(let e=b+1;e<a.length;e++){const f=a[e];Aa(d,f)&&(d.start=Math.min(d.start,f.start),d.end=Math.max(d.end,f.end),a.splice(e,1),e--,c&&c(f))}}}
function Ba(a){for(let b=0;b<a.length;b++){const d=a[b];for(let e=b+1;e<a.length;e++){var c=a[e];if(Aa({start:d.left,end:d.left+d.width},{start:c.left,end:c.left+c.width})){const f=Math.min(d.left,c.left),g=Math.max(d.left+d.width,c.left+c.width),h=Math.min(d.top,c.top);c=Math.max(d.top+d.height,c.top+c.height);d.left=f;d.width=g-f;d.top=h;d.height=c-h;a.splice(e,1);e--}}}}function Aa(a,c){return Math.max(a.start,c.start)<=Math.min(a.end,c.end)}
function Ca(){return"FinalizationRegistry"in window&&"WeakRef"in window}let Da=null,Ga=null,Ha=null;function Ia(a){if(Da)return Da;a=a.constructor;if(!a||"function"!==typeof a)return null;a=a.toString().match(/this\.[a-zA-Z0-9$_\.]+=\[\];(.*?)this\.[a-zA-Z0-9$_\.]+=\[\]/);if(!a)return null;a=a[1].match(/(?<=this\.)[a-zA-Z0-9$_\.]+(?==[a-zA-Z0-9$_\.]+\(\);)/g);if(!a)return null;Da=a[4];return a[4]}
function Ja(a){if(Ga)return Ga;a=a.constructor;if(!a||"function"!==typeof a)return null;a=a.toString().match(/this\.[a-zA-Z0-9$_\.]+=\[\];(.*?)this\.[a-zA-Z0-9$_\.]+=\[\]/);if(!a)return null;a=a[1].match(/(?<=this\.)[a-zA-Z0-9$_\.]+(?==[a-zA-Z0-9$_\.]+\(\);)/g);if(!a)return null;Ga=a[3];return a[3]}
function Ka(a){if(Ha)return Ha;a=a.constructor;if(!a||"function"!==typeof a)return null;a=a.toString().match(/this\.([a-zA-Z0-9$_\.]+)=\[\];.*?this\.([a-zA-Z0-9$_\.]+)=\[\]/);if(!a)return null;Ha=a[1];return a[1]}function La(a){var c=Ka(a),b=Ja(a);const d=Ia(a);if(!c||!b||!d)return null;c=a[c];const e=a[b],f=a[d];a=Object.keys(e).map(g=>e[g]).find(g=>Array.isArray(g));b=Object.keys(f).map(g=>f[g]).find(g=>Array.isArray(g));return{sa:c,oa:b,ta:a}}
function Ma(a){return a.replace(/[\u200b\u200c\u202c\u202d]/g,"")};var Na=class{constructor(a,c,b,d){this.type="spellcheck";this.g=[];this.i=a;this.h=c;this.text=b;this.g=d}};function Oa(a){if(!a.h){const c=a.i();if(!c)throw Error("Could not get parent");a.h=c}return a.h}function Pa(a){const c=Oa(a);if(!a.g){const d=Oa(a).__proto__;var b=Object.keys(d);for(const e of b)if(b=d[e],0===b.length&&(b=b.toString(),"function(){return this[a]}"!==b&&!b.includes("getStyle")&&b.includes("a=[]")&&b.includes("for(")&&b.includes("a.push(")&&b.includes("return a"))){a.g=e;break}}if(!a.g)throw Error("Could not get key");return(a=c[a.g]())&&Array.isArray(a)?a:[]}
var Qa=class{constructor(a){this.h=this.g=null;this.i=a}};function Ra(a){if(!a.h){const c=a.i();if(!c)throw Error("Could not get parent");a.h=c}return a.h}function Sa(a){if(!a.g){const d=Ra(a);var c=Object.keys(d).filter(e=>"object"===typeof d[e]&&d[e]&&"clear"in d[e]);for(const e of c){c=d[e].__proto__;var b=Object.keys(c);for(const f of b)if(b=c[f],1===b.length&&b.toString().includes("getType")){a.g=[e,f];break}if(a.g)break}}if(!a.g)throw Error("Could not get key");return a.g}var Ta=class{constructor(a){this.h=this.g=null;this.i=a}};function Ua(a){if(!a.h){const c=a.i();if(!c)throw Error("Could not get parent");a.h=c}return a.h}var Va=class{constructor(a){this.h=this.g=null;this.i=a}};var Wa=class{constructor(a,c){this.type=a;this.id=c}};var Xa=class extends Wa{constructor(a,c,b,d,e){super(a,c);this.title=b;this.description=d;this.url=e}};function Ya(a,c){if(!a.i)for(const b of Object.keys(c)){const d=c[b];if(d&&"object"===typeof d&&0!==Object.keys(d).filter(e=>"string"===typeof d[e]).length){a.i=b;break}}return a.i?c[a.i]:null}
function Za(a,c){if(!a.g||!a.h)for(var b of Object.keys(c)){var d=c[b];if("string"===typeof d&&(a.h||"inline"!==d?!a.g&&d.startsWith("kix.")&&(a.g=b):a.h=b,a.g&&a.h))break}d=a.g&&a.h?{type:c[a.h],id:c[a.g]}:null;if(!d)return null;b=d.type;d=d.id;if(!a.j)for(var e of Object.keys(c)){var f=c[e];if(f&&"object"===typeof f&&"function"===typeof f.getType){a.j=e;break}}c=a.j?c[a.j]:null;if(!c)return null;a:{if(!a.o||!a.m){b:{for(e=c;e=e.__proto__;)if(Object.keys(e).includes("getType")){e=e.constructor.toString();
break b}e=null}if(!e){e=null;break a}e=e.match(/;this\.([a-zA-Z0-9$_]+)=this\.([a-zA-Z0-9$_]+)=null;/);if(!e){e=null;break a}a.o=e[2];a.m=e[1]}e={title:c[a.o],description:c[a.m]}}f=e;if(!f)return null;e=f.title;f=f.description;if(!a.l)for(const g of Object.keys(c)){const h=c[g];if("string"===typeof h&&(h.startsWith("http://")||h.startsWith("https://"))){a.l=g;break}}return new Xa(b,d,e,f,a.l?c[a.l]:null)}var $a=class{constructor(){this.l=this.m=this.o=this.j=this.h=this.g=this.i=null}};function ab(a){return Pa(a.h).filter(c=>!!c).map(c=>{var b=a.g;return b=(c=Ya(b,c))?Za(b,c):null}).filter(c=>!!c)}function bb(a,c){{var b=a.i;let d=Ra(b);b=Sa(b);for(let e=0;e<b.length-1;e++)d=d[b[e]];c=d[b[b.length-1]](c)}return c?(a=Za(a.g,c))?a:null:null}
function cb(a,c,b){{var d=a.j;let f=Ua(d);if(!d.g){const g=Ua(d).__proto__;var e=Object.keys(g);for(const h of e)e=g[h],2===e.length&&(e=e.toString(),!e.includes("getStyle")&&e.includes("var c=this.")&&e.includes("a[0]")&&e.includes(".get(b):")&&(d.g=h))}if(!d.g)throw Error("Could not get key");c=f[d.g](c,b)}return c?(a=Za(a.g,c))?a:null:null}var db=class{constructor(a){this.h=new Qa(a);this.i=new Ta(a);this.j=new Va(a);this.g=new $a}};function eb(){const a=new ma;a:if(a.h)var c=a.h;else{c=window.KX_kixApp;for(var b in c){const e=c[b];if(e instanceof Object&&!Array.isArray(e)&&!J(e)&&!da(e))for(const f in e){const g=e[f];if(g&&g instanceof Object&&!Array.isArray(g)&&!J(g)&&!da(g)&&"function"===typeof g.getSelection){c=a.h=e;break a}}}throw Error("Unable to get context!");}a:if(null!==a.i)var d=a.i;else{for(d in c)if((b=c[d])&&"function"===typeof b.getSelection){d=a.i=b;break a}throw Error("Unable to get document!");}return new fb(d,
fa(a),a)}function gb(a){for(const c in a.g){const b=a.g[c];try{if(b&&b.getStyle&&"function"===typeof b.getStyle)return b}catch(d){}}throw Error("Unable to get content!");}function hb(a){if(!a.U){a.U=!0;var c=ib(a);if(null===c)throw Error("Unable to find the key of the selection!");var b=a.g[c];Object.defineProperty(a.g,c,{configurable:!0,enumerable:!0,get:()=>b,set:d=>{const e=b;b=d;e!==d&&A(a.W,a.getSelection())}})}}
function jb(a){if(!a.H){a.H=!0;var c=ha(),b=ja(),d=a.V,e=function(...f){try{f[0]===c&&A(d,f[f.length-1])}catch(g){console.error(g)}return b.value.apply(this,Array.from(arguments))};b.parent[b.key]=e;b.ra=e;a.o=b}}function kb(a){const c=lb(a);let b=null;for(const d in c)if("string"===typeof c[d]){b=d;break}b&&(a.h=c[b],Object.defineProperty(c,b,{configurable:!0,enumerable:!0,get:()=>a.h,set:d=>{const e=a.h;a.h=d;e!==d&&A(a.aa,d,e)}}))}
function mb(a){var c=nb(a,a.g);if(null===c)console.error("Unable to initialize listener for spellcheck changes!");else{var b=ob(a.g);if(c=c.map(n=>F(`this.${n}`,{"this":b})).find(n=>"spellcheck"in n)){var d=c.spellcheck,e=Object.keys(d).map(n=>d[n]).find(n=>Object.keys(n).map(r=>n[r]).filter(r=>Array.isArray(r)).length===Object.keys(n).length);if(e){var f=Object.keys(e).find(n=>"number"===typeof e[n][0]);if(f){var g=Object.keys(e).find(n=>n!==f);if(g){var h=Array.from(e[g]).filter(n=>void 0!==n),
k=n=>{const r=n.length;if(r!==h.length)return!0;for(let q=0;q<r;q++)if(n[q]!==h[q])return!0;return!1},l=null,m=()=>{null!==l&&(window.clearTimeout(l),l=null);l=window.setTimeout(()=>{const n=Array.from(e[g]).filter(r=>void 0!==r);k(n)&&(h=n,A(a.$))},0)},p=n=>{const r=n.push,q=n.splice,v=n.shift,u=n.unshift;n.push=function(){m();return r.apply(this,arguments)};n.splice=function(){m();return q.apply(this,arguments)};n.shift=function(){m();return v.apply(this,arguments)};n.unshift=function(){m();return u.apply(this,
arguments)}},t=e[f];p(t);Object.defineProperty(e,f,{configurable:!0,enumerable:!0,get:()=>t,set:n=>{p(n);t=n;m()}})}else console.error("Unable to find spellcheck value container")}else console.error("Unable to find spellcheck index container")}else console.error("Unable to find spellcheck index container")}else console.error("Unable to find spellcheck object")}}function pb(a){hb(a);jb(a);kb(a);mb(a)}function ib(a){const c=a.g.getSelection();for(const b in a.g)if(a.g[b]===c)return b;return null}
function ob(a){if(a.getStyle&&"function"===typeof a.getStyle)return a;for(const c in a)if("object"===typeof a[c]&&a[c].getStyle&&"function"===typeof a[c].getStyle)return a[c];throw Error("Unable to get document data!");}function qb(a,c){var b=a.C.get(c);if(b)return b;b=ob(c);b=b.getStyle.bind(b);a.C.set(c,b);return b}
function rb(a,c){var b=a.s.get(c);if(b)return b;b=new Map;const d=/return this\.([a-zA-Z0-9$_]+)\.([a-zA-Z0-9$_]+)\(a\)/;for(const e in c){const f=c[e];if("function"!==typeof f)continue;const g=f.toString().match(d);g&&g[2]===e&&b.set(e,f)}a.s.set(c,b);return b}function sb(a,c){a=rb(a,c);for(const [b,d]of a)if((a=d.call(c,"paragraph"))&&Array.isArray(a)&&0!==a.length&&a.filter(e=>"number"===typeof e).length===a.length)return b;return null}
function tb(a,c){var b=a.B.get(c);if(b)return b;b=ob(c);const d=sb(a,b);if(null===d)throw Error("Unable to get list indexes of type method!");b=b[d].bind(b);a.B.set(c,b);return b}function nb(a,c){c=ob(c);a=sb(a,c);if(null===a)return null;const b=c[a].toString().match(/this\.([a-zA-Z0-9$_]+)\./);if(!b)return null;const d=b[1];c=c[d][a];return"function"!==typeof c?null:(c=c.toString().match(/(?<=this\.)([a-zA-Z0-9$_]+)(?=\[)/g))?Array.from(c).map(e=>`${d}.${e}`):null}
function ub(a,c,b){var d=c.constructor.toString(),e=d.match(/this\.([a-zA-Z0-9$_]+)=this\.([a-zA-Z0-9$_]+)=null;/);if(!e)return null;d=d.match(/(?<=this\.)[a-zA-Z0-9$_]+(?==new)/g);if(!d)return null;d=d.map(g=>c[g]).map(g=>Object.keys(g).map(h=>g[h]).filter(h=>Array.isArray(h)&&0<h.length&&h.filter(k=>"string"===typeof k).length===h.length).find(()=>!0)||[]).flat(1);const f=c[e[1]];e=c[e[2]];a=vb(a,b);null===a&&(a="SPELLING_ERROR");return new Na(a,f,e,d)}
function wb(a,c,b){const d=qb(a,a.g)(c,b);switch(c){case "equation":return new na;case "equation_function":a=Object.keys(d).filter(e=>"string"===typeof d[e]&&d[e]!==c);if(1!==a.length)throw Error("Unable to decode type `equation_function`!");return new oa(d[a[0]]);case "spellcheck":a=ub(a,d,b);if(!a)throw Error("Unable to decode type `spellcheck`!");return a;default:return{type:c}}}
function vb(a,c){const b=xb(a);if(null===b)return null;const d=gb(a),e=b(d,c,!0,null);if(!e)return null;c=Object.keys(e).map(f=>e[f]).find(f=>{const g=Object.keys(f).map(h=>f[h]).map(h=>Array.isArray(h)?"array":typeof h);return 2===g.filter(h=>"array"===h).length&&2===g.filter(h=>"string"===h).length});if(!c)return null;a=yb(a);return null===a?null:a(c)?"GRAMMAR_ERROR":"SPELLING_ERROR"}function zb(a){return[1,...tb(a,a.g)("paragraph").map(c=>c+1)]}
function Ab(a){var c=tb(a,a.g)("spellcheck");const b=new Map;for(const d of c)c=wb(a,"spellcheck",d),null!==c.text&&b.set(d,c);return b}function xb(a){if(null!==a.i)return a.i;const c=window;a:{for(b in c)if("spellcheck"===c[b])break a;var b=null}if(null===b)return null;for(const e in c)if("function"===typeof c[e]){var d=c[e].toString();if(d.match(/function(?: [a-zA-Z0-9$_]+)?\(a,b,c,d\){/)&&(d=d.match(new RegExp(`\\.getStyle\\(${E(b)},b`,"g")))&&2===d.length)return a.i=c[e],c[e]}return null}
function Bb(a){if(null!==a.l)return a.l;const c=[0,5,7,8,30],b=window;for(const d in b){if("function"!==typeof b[d])continue;const e=b[d].toString();if(void 0===c.find(f=>!e.includes(`case ${f}:`)))return a.l=d}return null}function yb(a){if(null!==a.j)return a.j;const c=Bb(a);if(null===c)return null;const b=window;for(const d in b)if("function"===typeof b[d]&&b[d].toString().match(new RegExp(`{(.*?)\\b${E(c)}\\(`)))return a.j=b[d],b[d];return null}
function Fb(a,c){var b=a.O;a=la(b);const {value:d}=ea(b),e=L(b,c.type);if(c instanceof P){const f=L(b,"CellBorderTuple");c=c.g.map(g=>new f(g.index,g.type));d(a,new e(c),!1,!0)}else if(c instanceof N)b=new e(c.G.start,!1,null),d(a,b,!1,!0),c.G.start!==c.G.end&&(c=new e(c.G.end,!1,null),d(a,c,!0,!0));else if(c instanceof qa)d(a,new e(c.index),!1,!0);else if(c instanceof ra)d(a,new e(c.id,c.g,c.index),!1,!0);else if(c instanceof O)d(a,new e(c.id),!1,!0);else throw Error("Unknown location type -> "+
c.type);}function Gb(a){a=a.g.getSelection();for(const c in a){const b=a[c];if(b&&"object"===typeof b&&"toString"in b&&b.toString.toString().match(/Location/))return b}return null}function lb(a){a=gb(a);for(const c in a){const b=a[c];if(b&&"function"===typeof b.insert)return b}throw Error("Unable to get text content!");}function Hb(a){a=lb(a);for(const c in a){const b=a[c];if("string"===typeof b)return b}return""}
function Ib(a){if(!a||"object"!==typeof a||Array.isArray(a))return!1;let c=!1,b=!1;for(const d in a){if("string"!==typeof d||"object"!==typeof a[d]||Array.isArray(a[d])||!a[d]||!("getId"in a[d]))return!1;d.startsWith("kix-")&&(c=!0);b=!0}return b&&c}
function Jb(a,c){const b=a.o||ja();a.o=b;if(!a.M){a:{var d=ha();for(var e in d){const f=d[e];if(f&&!Array.isArray(f)&&"object"===typeof f)for(const g in f){const h=f[g];if(h&&!Array.isArray(h)&&"object"===typeof h)for(const k in h)if(Ib(h[k])){d=h;break a}}}d=null}e=!1;for(const f in d)if(Ib(d[f])&&"kix-insert-equation"in d[f]){e=!0;break}if(!e)throw Error("kix-insert-equation module is not ready!");a.M=!0}b.Ha(c)}
var fb=class{constructor(a,c,b){this.V=new C;this.W=new C;this.aa=new C;this.$=new C;this.h="";this.o=null;this.M=this.H=this.U=!1;this.B=new Map;this.s=new Map;this.C=new Map;this.j=this.l=this.i=null;this.g=a;this.ca=c;this.O=b;this.m=new db(()=>gb(this))}getSelection(){var a=this.g.getSelection();for(var c in a){var b=a[c];if(Array.isArray(b)&&0<b.length)return a=b[0],new N({start:a.start,end:a.end+1})}const d=Gb(this);if(d){var e=this.O;a=L(e,"CellBorderLocation");c=L(e,"InlineLocation");b=L(e,
"ListItemLocation");const f=L(e,"ListNestingLevelLocation");e=L(e,"PositionedLocation");if(d instanceof a){a=(()=>{for(const g in d){const h=d[g];if(h&&Array.isArray(h))return h}return null})();if(null===a)return new N({start:-1,end:-1});a=a.map(g=>{const h=Q(g,/this\.([a-zA-Z0-9$_]+)=a/);g=Q(g,/this\.([a-zA-Z0-9$_]+)=b/);if(null===h||null===g)throw Error("Unable to get index or/and type");return new pa(g,h)});return new P(a)}if(d instanceof c)return a=Q(d,/this\.([a-zA-Z0-9$_]+)=a/),null===a?new N({start:-1,
end:-1}):new N({start:a,end:a});if(d instanceof b)return a=Q(d,/this\.([a-zA-Z0-9$_]+)=a/),null===a?new N({start:-1,end:-1}):new qa(a);if(d instanceof f)return a=Q(d,/this\.([a-zA-Z0-9$_]+)=a/),c=Q(d,/this\.([a-zA-Z0-9$_]+)=b/),b=Q(d,/this\.([a-zA-Z0-9$_]+)=c/),null===a||null===c||null===b?new N({start:-1,end:-1}):new ra(a,c,b);if(d instanceof e)return a=(()=>{for(const g in d){const h=d[g];if("string"===typeof h)return h}return null})(),null===a?new N({start:-1,end:-1}):new O(a)}return new N({start:-1,
end:-1})}};function Kb(a,c){if(!a||!c||a.charAt(0)!==c.charAt(0))return 0;let b=0,d=Math.min(a.length,c.length),e=d,f=0;for(;b<e;)a.substring(f,e)==c.substring(f,e)?f=b=e:d=e,e=Math.floor((d-b)/2+b);return e}function Lb(a,c){if(!a||!c||a.charAt(a.length-1)!==c.charAt(c.length-1))return 0;let b=0,d=Math.min(a.length,c.length),e=d,f=0;for(;b<e;)a.substring(a.length-e,a.length-f)==c.substring(c.length-e,c.length-f)?f=b=e:d=e,e=Math.floor((d-b)/2+b);return e}
function Mb(a,c,b,d,e){if(!c)return[["insert",b]];if(!b)return[["delete",c]];var f=c.length>b.length?c:b,g=c.length>b.length?b:c,h=f.indexOf(g);if(-1!==h)return a=[["insert",f.substring(0,h)],["equal",g],["insert",f.substring(h+g.length)]],c.length>b.length&&(a[0][0]=a[2][0]="delete"),a;if(1===g.length)return[["delete",c],["insert",b]];if(f=Nb(c,b))return b=f[1],g=f[3],c=f[4],f=S(a,f[0],f[2],d,e),a=S(a,b,g,d,e),f.concat([["equal",c]],a);if(d&&100<c.length&&100<b.length){d=Ob(c,b);c=d.xa;b=d.ya;d=
d.Ca;b=c=S(a,c,b,!1,e);for(f=0;f<b.length;f++){g=b[f][1];h=[];for(var k=0;k<g.length;k++)h[k]=d[g.charCodeAt(k)];b[f][1]=h.join("")}b=c;f=!1;g=[];h=0;k=null;for(var l=d=0,m=0,p=0,t=0;d<b.length;)"equal"===b[d][0]?(g[h++]=d,l=p,m=t,t=p=0,k=b[d][1]):("insert"===b[d][0]?p+=b[d][1].length:t+=b[d][1].length,k&&k.length<=Math.max(l,m)&&k.length<=Math.max(p,t)&&(b.splice(g[h-1],0,["delete",k]),b[g[h-1]+1][0]="insert",h--,h--,d=0<h?g[h-1]:-1,t=p=m=l=0,k=null,f=!0)),d++;f&&Pb(a,b);Qb(b);for(d=1;d<b.length;){if("delete"===
b[d-1][0]&&"insert"===b[d][0]){f=b[d-1][1];g=b[d][1];h=Rb(f,g);k=Rb(g,f);if(h>=k){if(h>=f.length/2||h>=g.length/2)b.splice(d,0,["equal",g.substring(0,h)]),b[d-1][1]=f.substring(0,f.length-h),b[d+1][1]=g.substring(h),d++}else if(k>=f.length/2||k>=g.length/2)b.splice(d,0,["equal",f.substring(0,k)]),b[d-1][0]="insert",b[d-1][1]=g.substring(0,g.length-k),b[d+1][0]="delete",b[d+1][1]=f.substring(k),d++;d++}d++}c.push(["equal",""]);f=d=b=0;for(h=g="";b<c.length;){switch(c[b][0]){case "insert":f++;h+=c[b][1];
break;case "delete":d++;g+=c[b][1];break;case "equal":if(1<=d&&1<=f){c.splice(b-d-f,d+f);b=b-d-f;d=S(a,g,h,!1,e);for(f=d.length-1;0<=f;f--)c.splice(b,0,d[f]);b+=d.length}d=f=0;h=g=""}b++}c.pop();a=c}else a:{d=c.length;f=b.length;g=Math.ceil((d+f)/2);h=2*g;k=Array(h);l=Array(h);for(m=0;m<h;m++)k[m]=-1,l[m]=-1;k[g+1]=0;l[g+1]=0;m=d-f;p=0!==m%2;let u=t=0,w=0,B=0;for(let z=0;z<g&&!((new Date).getTime()>e);z++){for(var n=-z+t;n<=z-u;n+=2){var r=g+n,q=void 0;q=n===-z||n!==z&&k[r-1]<k[r+1]?k[r+1]:k[r-1]+
1;for(var v=q-n;q<d&&v<f&&c.charAt(q)===b.charAt(v);)q++,v++;k[r]=q;if(q>d)u+=2;else if(v>f)t+=2;else if(p&&(r=g+m-n,0<=r&&r<h&&-1!==l[r]&&q>=d-l[r])){a=Sb(a,c,b,q,v,e);break a}}for(n=-z+w;n<=z-B;n+=2){v=g+n;q=n===-z||n!==z&&l[v-1]<l[v+1]?l[v+1]:l[v-1]+1;for(r=q-n;q<d&&r<f&&c.charAt(d-q-1)==b.charAt(f-r-1);)q++,r++;l[v]=q;if(q>d)B+=2;else if(r>f)w+=2;else if(!p&&(r=g+m-n,0<=r&&r<h&&-1!==k[r]&&(v=k[r],r=g+v-r,q=d-q,v>=q))){a=Sb(a,c,b,v,r,e);break a}}}a=[["delete",c],["insert",b]]}return a}
function Pb(a,c){c.push(["equal",""]);let b=0;var d=0;let e=0,f="",g="",h;for(;b<c.length;)switch(c[b][0]){case "insert":e++;g+=c[b][1];b++;break;case "delete":d++;f+=c[b][1];b++;break;case "equal":1<d+e?(0!==d&&0!==e&&(h=Kb(g,f),0!==h&&(0<b-d-e&&"equal"==c[b-d-e-1][0]?c[b-d-e-1][1]+=g.substring(0,h):(c.splice(0,0,["equal",g.substring(0,h)]),b++),g=g.substring(h),f=f.substring(h)),h=Lb(g,f),0!==h&&(c[b][1]=g.substring(g.length-h)+c[b][1],g=g.substring(0,g.length-h),f=f.substring(0,f.length-h))),0===
d?c.splice(b-e,d+e,["insert",g]):0===e?c.splice(b-d,d+e,["delete",f]):c.splice(b-d-e,d+e,["delete",f],["insert",g]),b=b-d-e+(d?1:0)+(e?1:0)+1):0!==b&&"equal"===c[b-1][0]?(c[b-1][1]+=c[b][1],c.splice(b,1)):b++,d=e=0,g=f=""}""===c[c.length-1][1]&&c.pop();d=!1;for(b=1;b<c.length-1;)"equal"===c[b-1][0]&&"equal"===c[b+1][0]&&(c[b][1].substring(c[b][1].length-c[b-1][1].length)===c[b-1][1]?(c[b][1]=c[b-1][1]+c[b][1].substring(0,c[b][1].length-c[b-1][1].length),c[b+1][1]=c[b-1][1]+c[b+1][1],c.splice(b-1,
1),d=!0):c[b][1].substring(0,c[b+1][1].length)==c[b+1][1]&&(c[b-1][1]+=c[b+1][1],c[b][1]=c[b][1].substring(c[b+1][1].length)+c[b+1][1],c.splice(b+1,1),d=!0)),b++;d&&Pb(a,c)}
function S(a,c,b,d=!0,e){"undefined"===typeof e&&(e=(new Date).getTime()+1E3);if(c===b)return[["equal",c]];var f=Kb(c,b);const g=c.substring(0,f);c=c.substring(f);b=b.substring(f);const h=Lb(c,b);f=c.substring(c.length-h);c=c.substring(0,c.length-h);b=b.substring(0,b.length-h);c=Mb(a,c,b,d,e);g&&c.unshift(["equal",g]);f&&c.push(["equal",f]);Pb(a,c);return c}
function Nb(a,c){var b=a.length>c.length?a:c,d=a.length>c.length?c:a;if(4>b.length||2*d.length<b.length)return null;const e=(g,h,k)=>{const l=g.substring(k,k+Math.floor(g.length/4));let m=-1,p="",t="",n="",r="",q="";for(;-1!==(m=h.indexOf(l,m+1));){const v=Kb(g.substring(k),h.substring(m)),u=Lb(g.substring(0,k),h.substring(0,m));p.length<u+v&&(p=h.substring(m-u,m)+h.substring(m,m+v),t=g.substring(0,k-u),n=g.substring(k+v),r=h.substring(0,m-u),q=h.substring(m+v))}return 2*p.length>=g.length?[t,n,r,
q,p]:null};var f=e(b,d,Math.ceil(b.length/4));b=e(b,d,Math.ceil(b.length/2));if(f||b){if(b||!f)if(!f&&b)f=b;else if(f&&b)f=f[4].length>b[4].length?f:b;else throw Error("This is unreachable");}else return null;a.length>c.length?(a=f[0],c=f[1],b=f[2],d=f[3]):(b=f[0],d=f[1],a=f[2],c=f[3]);return[a,c,b,d,f[4]]}
function Ob(a,c){const b=[],d={};b[0]="";const e=f=>{let g="",h=0,k=-1,l=b.length;for(;k<f.length-1;){k=f.indexOf("\n",h);-1===k&&(k=f.length-1);const m=f.substring(h,k+1);h=k+1;(d.hasOwnProperty?d.hasOwnProperty(m):void 0!==d[m])?g+=String.fromCharCode(d[m]):(g+=String.fromCharCode(l),d[m]=l,b[l++]=m)}return g};a=e(a);c=e(c);return{xa:a,ya:c,Ca:b}}function Sb(a,c,b,d,e,f){const g=c.substring(d),h=b.substring(e);c=S(a,c.substring(0,d),b.substring(0,e),!1,f);a=S(a,g,h,!1,f);return c.concat(a)}
function Rb(a,c){var b=a.length,d=c.length;if(0===b||0===d)return 0;b>d?a=a.substring(b-d):b<d&&(c=c.substring(0,b));b=Math.min(b,d);if(a===c)return b;d=0;let e=1;for(;;){const f=c.indexOf(a.substring(b-e));if(-1===f)return d;e+=f;if(0===f||a.substring(b-e)==c.substring(0,e))d=e,e++}}
function Qb(a){const c=(f,g)=>{if(!f||!g)return 6;var h=f.charAt(f.length-1),k=g.charAt(0);const l=h.match(Tb),m=k.match(Tb),p=l&&h.match(Ub),t=m&&k.match(Ub);h=p&&h.match(Vb);k=t&&k.match(Vb);f=h&&f.match(Wb);g=k&&g.match(Xb);return f||g?5:h||k?4:l&&!p&&t?3:p||t?2:l||m?1:0};let b=1;for(;b<a.length-1;){if("equal"===a[b-1][0]&&"equal"===a[b+1][0]){let f=a[b-1][1],g=a[b][1],h=a[b+1][1];var d=Lb(f,g);if(d){var e=g.substring(g.length-d);f=f.substring(0,f.length-d);g=e+g.substring(0,g.length-d);h=e+h}d=
f;e=g;let k=h,l=c(f,g)+c(g,h);for(;g.charAt(0)===h.charAt(0);){f+=g.charAt(0);g=g.substring(1)+h.charAt(0);h=h.substring(1);const m=c(f,g)+c(g,h);m>=l&&(l=m,d=f,e=g,k=h)}a[b-1][1]!=d&&(d?a[b-1][1]=d:(a.splice(b-1,1),b--),a[b][1]=e,k?a[b+1][1]=k:(a.splice(b+1,1),b--))}b++}}var Yb=class{constructor(){}},Tb=/[^a-zA-Z0-9]/,Ub=/\s/,Vb=/[\r\n]/,Wb=/\n\r?\n$/,Xb=/^\r?\n\r?\n/;function Zb({set:a,ba:c}){a.delete(c)}
var $b=class{constructor(){this.Y=new WeakMap;this.X=new Set;this.ma=new WeakMap;this.la=new FinalizationRegistry(Zb)}set(a,c){var b=this.ma.get(a);b||(b=new WeakRef(a),this.ma.set(a,b));this.Y.set(a,{value:c,ba:b});this.X.has(b)||this.X.add(b);this.la.register(a,{set:this.X,ba:b},b)}get(a){a=this.Y.get(a);if(void 0!==a)return a.value}delete(a){const c=this.Y.get(a);if(!c)return!1;this.Y.delete(a);this.X.delete(c.ba);this.la.unregister(c.ba);return!0}*[Symbol.iterator](){for(const a of this.X){const c=a.deref();
if(!c)continue;const {value:b}=this.Y.get(c);yield[c,b]}}entries(){return this[Symbol.iterator]()}*keys(){for(const [a]of this)yield a}*values(){for(const [,a]of this)yield a}};var ac=Symbol("WizkidsData"),bc=Symbol("MeasureText"),cc=Symbol("DataChangesSymbol"),dc=Symbol("GetRectsSymbol"),ec=Symbol("AlreadyHandledSymbol");const fc=/return!!this\.([a-zA-Z0-9$_]+)\|\|/,gc=/function(?: [a-zA-Z0-9$_]+)?\([a-zA-Z0-9$_]+\){this\.[a-zA-Z0-9$_]+=[a-zA-Z0-9$_]+}/,hc=/function(?: [a-zA-Z0-9$_]+)?\([a-zA-Z0-9$_]+,[a-zA-Z0-9$_]+,[a-zA-Z0-9$_]+\){this\.[a-zA-Z0-9$_]+=[a-zA-Z0-9$_]+}/;
function ic(a,c){if(a.l)return a.l;a:if(a.h)var b=a.h;else{c=c.constructor.prototype;for(b in c){const d=c[b];if("function"===typeof d&&fc.test(d.toString())){b=a.h=d;break a}}b=null}if(!b)return null;b=b.toString().match(/return!!this\.([a-zA-Z0-9$_]+)\|\|/);if(!b)return null;a.l=b[1];return b[1]}
function jc(a,c,b){const d=ic(a,c);if(d&&!c[d]){b=F(b,{a:c}).getData();a:if(a.g)var e=a.g;else{for(e in b){const h=b[e];if("object"===typeof h&&!Array.isArray(h)&&h&&"getHeight"in h){a.g=e;break a}}e=null}if(e){var f=b[e];a:if(a.j)a=a.j;else{b=window;for(var g in b)if(e=b[g],"function"===typeof e&&"prototype"in e&&"object"===typeof e.prototype&&gc.test(e.toString())&&3===Object.keys(e.prototype).length&&"getType"in e.prototype&&"function"===typeof e.prototype.getType){a=a.j=g;break a}a=null}a&&(c[d]=
new window[a](f))}else{a:if(a.i)a=a.i;else{g=window;for(f in g)if(b=g[f],"function"===typeof b&&"prototype"in b&&"object"===typeof b.prototype&&hc.test(b.toString())&&3===Object.keys(b.prototype).length&&"getType"in b.prototype&&"function"===typeof b.prototype.getType){a=a.i=f;break a}a=null}a&&(c[d]=new window[a](null,null,!0))}}}var kc=class{constructor(){this.i=this.j=this.g=this.l=this.h=null}};var lc=class{constructor(){this.g=[];this.h=[]}set(a,c){const b=this.g.indexOf(a);-1===b?(this.g.push(a),this.h.push(c)):this.h[b]=c}get(a){a=this.g.indexOf(a);if(-1!==a)return this.h[a]}delete(a){a=this.g.indexOf(a);if(-1===a)return!1;this.g.splice(a,1);this.h.splice(a,1);return!0}*[Symbol.iterator](){for(let a=0;a<this.g.length;a++)yield[this.g[a],this.h[a]]}entries(){return this[Symbol.iterator]()}*keys(){for(const a of this.g)yield a}*values(){for(const a of this.h)yield a}};function mc(a,c,b){for(const [,d]of a.h)d.ea.push({type:"insert",index:c,length:b})}function nc(a,c,b){for(const [,d]of a.h)d.ea.push({type:"delete",index:c,length:b})}function oc(){const a=window;for(const c in a){const b=a[c];if("function"===typeof b&&b.toString().match(/function(?: [a-zA-Z0-9$_]+)?\(a(,[a-z])*\){.+\.getContext\(\).+\.getContext\(\).+\.getData\(\)/))return{parent:a,key:c,value:b}}return null}
function pc(a){return(a=a.toString().match(/;(a\.[a-zA-Z0-9$_\.]+)\.getData\(\)/))?a[1]:null}function qc(a,c){if(a.j)return a.j;for(const d in c){var b=c[d];if(Array.isArray(b)&&0!==b.length&&(b=b[0],!("start"in b&&"end"in b)))for(const e in b)if(!Array.isArray(b[e]))return a.j=d}return null}
function rc(a){if(a.i)return a.i;const c=wa(/Math\.min\([a-zA-Z0-9$_]+\.length,.*?\.push\(/);if(!c)throw Error("Unable to find measureText function!");const b=sc(a,c,new RegExp("function(?: [a-zA-Z0-9$_]+)?\\([a-zA-Z0-9$_,]+\\){[^;]+;[a-zA-Z0-9$_]+="+E(c.key.toString())+"\\(")),d=sc(a,b.path);var e=tc(a,d.path).map(n=>n.path.value.toString().match(new RegExp("this\\.([a-zA-Z0-9$_]+)\\[0\\].*?\\([a-zA-Z0-9$_]+=(this\\..*?),[a-zA-Z0-9$_]+="+E(d.path.key.toString())+"\\((this\\.[a-zA-Z0-9$_]+),"))).find(n=>
n);if(!e)throw Error("Unable to get matches!");const f=e[1],g=e[2],h=e[3];e=d.link.find(n=>4<n.length);if(!e)throw Error("Unable to find style mapping!");const [k,l]=e.map(n=>n.match(/\[(.*?)\]/)).filter(n=>!!n).map(n=>n[1]).filter((n,r,q)=>q.indexOf(n)===r),m=e.filter(n=>n.includes("["+k+"]")),p=e.filter(n=>n.includes("["+l+"]")),t=(n,r,q)=>{let v=0;for(let u=0;u<=q;u++){const w=F("this"+p[0].replace("["+l+"]",""),{"this":"object"===typeof r?r:n[f][r]});u in w&&(v=u)}return v};a.i=(n,r,q)=>{const v=
t(n,r,q),u=p.map(K=>F("this"+K,{"this":"object"===typeof r?r:n[f][r],[l]:v}));var w=F(g,{"this":n});const B=F(h+d.link[0][0]+b.link[0][0],{"this":n}),z=m.map(K=>F("this"+K,{"this":"object"===typeof r?r:n[f][r],[k]:q}));w=[B,z[0],...u,w];return{fa:c.value(...w),style:u}};return a.i}
function sc(a,c,b=new RegExp("(?<!function )(?<![a-zA-Z0-9$_])"+E(c.key.toString())+"\\(")){a=wa(b);if(!a)throw Error("Unable to find example of function that calls measureText!");var d=a.value.toString();b=d.match(/function(?: [a-zA-Z0-9$_]+)?\((.*?)\)/);if(!b)throw Error("Unable to extract parameters of function!");d=d.match(new RegExp("(?<![a-zA-Z0-9$_])"+E(c.key.toString())+"\\(([\\w\\W]+)"));if(!d)throw Error("Unable to extract arguments of function!");c=[];let e=1;for(var f of d[1]){")"===f?
e--:"("===f&&e++;if(0===e)break;c.push(f)}f=b[1].split(",");b=(g=>{const h=[];let k="",l=!1;for(const m of g)","!==m||l?("("===m?l=!0:")"===m&&(l=!1),k+=m):(h.push(k),k="");k&&h.push(k);return h})(c).map(g=>{const h=g.match(/^[a-zA-Z0-9$_]+\(([^\),]+),([^\)]+)\)$/);return h?`${h[1]}[${h[2]}]`:g});f=uc(f,b);return{path:a,link:f}}
function tc(a,c,b=new RegExp("(?<!function )(?<![a-zA-Z0-9$_])"+E(c.key.toString())+"\\(")){if(a=xa.get(b.toString()))b=a;else{a=window;var d=[];for(var e in a){var f=a[e];if("function"===typeof f){var g=f.toString();if(!g.includes("[native code]")&&(b.test(g)&&d.push({parent:a,key:e,value:f}),"prototype"in f)){f=f.prototype;for(const h in f)"error"!==h&&"constructor"!==h&&"lower"!==h&&(g=Object.getOwnPropertyDescriptor(f,h),null!==g&&void 0!==g&&g.value&&(g=f[h],"function"===typeof g&&b.test(g.toString())&&
d.push({parent:f,key:h,value:g})))}}}xa.set(b.toString(),d);b=d}e=[];for(const h of b)try{e.push(vc(c,h))}catch(k){console.error(k)}return e}function uc(a,c){const b=[];for(let d=0;d<a.length;d++){const e=new RegExp("^"+E(a[d])+"(?![a-zA-Z0-9$_])"),f=c.filter(g=>g.match(e));b[d]=f.map(g=>g.replace(e,""))}return b}
function vc(a,c){var b=c.value.toString(),d=b.match(/function(?: [a-zA-Z0-9$_]+)?\((.*?)\)/);if(!d)throw Error("Unable to extract parameters of function!");b=b.match(new RegExp("(?<![a-zA-Z0-9$_])"+E(a.key.toString())+"\\(([\\w\\W]+)"));if(!b)throw Error("Unable to extract arguments of function!");a=[];let e=1;for(var f of b[1]){")"===f?e--:"("===f&&e++;if(0===e)break;a.push(f)}d=d[1].split(",");f=(g=>{const h=[];let k="",l=!1;for(const m of g)","!==m||l?("("===m?l=!0:")"===m&&(l=!1),k+=m):(h.push(k),
k="");k&&h.push(k);return h})(a).map(g=>{const h=g.match(/^[a-zA-Z0-9$_]+\(([^\),]+),([^\)]+)\)$/);return h?`${h[1]}[${h[2]}]`:g});d=uc(d,f);return{path:c,link:d}}
var wc=class{constructor(){this.C=new C;this.l=!1;this.h=Ca()?new $b:new lc;this.j=this.g=null;this.B=new kc}U(){if(!this.l){var a=oc();if(!a)throw Error("Unable to find the function that keeps the index for the overlay rendering!");var c=this,b=pc(a.value);if(!b)throw Error("Unable to find the path to the data!");this.g=a;a.parent[a.key]=function(...d){try{(()=>{const [e,,f]=d;var g=F(b,{a:e}).getData();const h={ea:[]};c.h.get(g)||jc(c.B,e,b);c.h.set(g,h);g[cc]=h;g[ac]=f;g[bc]=c.o.bind(c,e);g[dc]=
c.m.bind(c,e);for(const k in e)e[k]&&"object"===typeof e[k]&&!Array.isArray(e[k])&&(e[k][dc]=c.m.bind(c,e));g=Object.keys(e).filter(k=>"object"===typeof e[k]&&e[k]&&"getType"in e[k]&&1===Object.keys(e[k]).length);1===g.length&&A(c.C,e[g[0]],f)})()}catch(e){console.error(e)}return a.value.apply(this,d)};this.l=!0}}M(){this.g&&(this.g.parent[this.g.key]=this.g.value,this.g=null)}m(a,c,b){if(c.start===c.end)return[];var d=qc(this,a);if(!d)return[];d=a[d];if(!d)return[];var e=Array.from(d);d=[];const f=
[],g=[],h=[],k=[],l=[];var m=0;for(var p=0;p<e.length;p++){var t=La(e[p]);if(!t)return[];var n=t.sa,r=t.ta;t=t.oa;for(var q=0;q<n.length;q++)f.push(n[q]),g.push(r[q]),h.push(t[q]),k.push(m),l.push(this.s.bind(this,a,e[p],q)),m+=n[q].length}a=0;if(b){a=[];for(e=0;e<f.length;e++)p=k[e],m=f[e].length,n=Math.max(b.index,p)-p,r=Math.min(p+m,b.index+b.length)-p,n>=r||(r-n==m?a.push(h[e]):(t=l[e](),p=t.style[4],t=t.fa,n=0===n?0:t.slice(0,n).reduce((u,w)=>u+w,0),m=r===m?0:t.slice(r,m).reduce((u,w)=>u+w,0),
a.push(h[e]+(p?n:m))));a=a.reduce((u,w)=>Math.min(u,w),Infinity)}for(e=0;e<f.length;e++){n=f[e].length;m=h[e]+(b?b.left-a:0);p=g[e];r=k[e];q=Math.max(c.start,r)-r;const u=Math.min(r+n,c.end)-r;if(!(q>=u)){var v=l[e]();r=v.style[1];t=v.style[4];u-q==n?d.push({left:m,top:0,width:p,height:r}):(v=v.fa,q=0===q?0:v.slice(0,q).reduce((w,B)=>w+B,0),n=u===n?0:v.slice(u,n).reduce((w,B)=>w+B,0),t?d.push({left:m+q,top:0,width:p-q-n,height:r}):d.push({left:m+n,top:0,width:p-q-n,height:r}))}}Ba(d);return d}s(a,
c,b){return rc(this)(a,c,b)}o(a,c,b){return rc(this)(a,c,b).fa}};function xc(a){if(!("type"in a)||"string"!==typeof a.type)return null;const c=a.type;return"CellBorderLocation"===c?new P(a.tuples.map(b=>new pa(b.type,b.index))):"InlineLocation"===c?new N(yc(a.range)):"ListItemLocation"===c?new qa(a.index):"ListNestingLevelLocation"===c?new ra(a.id,a.level,a.index):"PositionedLocation"===c?new O(a.id):null}function yc(a){return{start:a.start,end:a.end}}
function zc(a){return a instanceof P?{type:a.type,tuples:a.g.map(c=>({type:c.type,index:c.index}))}:a instanceof N?{type:a.type,range:{start:a.G.start,end:a.G.end}}:a instanceof qa?{type:a.type,index:a.index}:a instanceof ra?{type:a.type,id:a.id,index:a.index,level:a.g}:a instanceof O?{type:a.type,id:a.id}:null}function Ac(a){return a instanceof oa?{type:a.type,fn:a.g}:a instanceof Na?{type:a.type,spellCheckType:a.i,language:a.h,text:a.text,corrections:a.g}:{type:a.type}}
function Bc(a){return a instanceof Xa?{type:a.type,id:a.id,url:a.url,title:a.title,description:a.description}:{type:a.type,id:a.id}};function Cc(){this.g||(this.g=new Dc);return this.g}var Dc=class{constructor(){this.i=new C;this.g=new C;this.h=new C}};var Ec=(a,c)=>new Proxy(a,Object.assign({get:(b,d)=>Reflect.get(b,d),set:(b,d,e)=>Reflect.set(b,d,e),has:(b,d)=>Reflect.has(b,d),deleteProperty:(b,d)=>Reflect.deleteProperty(b,d),defineProperty:(b,d,e)=>Reflect.defineProperty(b,d,e),getOwnPropertyDescriptor:(b,d)=>Reflect.getOwnPropertyDescriptor(b,d),getPrototypeOf:b=>Reflect.getPrototypeOf(b),isExtensible:b=>Reflect.isExtensible(b),preventExtensions:b=>Reflect.preventExtensions(b),ownKeys:b=>Reflect.ownKeys(b),setPrototypeOf:(b,d)=>Reflect.setPrototypeOf(b,
d)},c));function Fc(a){return Ec(a.i,{get:(c,b,d)=>{a.g.g=!0;const e=Reflect.get(c,b);a.g.g=!1;return"function"!==typeof e?e:function(...f){const g={u:b,A:f,result:void 0};let h=!1,k=!1;try{const l=A(a.h.g,d,g,()=>{h=!0});l instanceof y&&"StopPropagation"===l.name&&(k=!0)}catch(l){console.error(l)}h||(g.result=e.apply(c,f));if(!k)try{A(a.h.h,d,g)}catch(l){console.error(l)}return g.result}},set:(c,b,d,e)=>{d={u:b,value:d};let f=!1;try{A(a.h.i,e,d,()=>{f=!0})}catch(g){console.error(g)}if(f)return!0;a.g.g=!0;
c=Reflect.set(c,b,d.value);a.g.g=!1;return c}})}var Gc=class{constructor(a,c,b){this.i=a;this.h=c;this.g=b}};var Hc=class{constructor(){this.g=!1}};function Ic(a,c,b){const d=a.h,e=a.g,f=Object.getOwnPropertyDescriptor(c,b);if(f){var g=f.set||(k=>f.value=k),h=f.get||(()=>f.value);Object.defineProperty(c,b,{configurable:f.configurable,enumerable:f.enumerable,get:function(){const k=h.call(this);return"function"!==typeof k||d.g?k:function(...l){if(d.g)return k.apply(this,l);const m={u:b,A:l,result:void 0};let p=!1,t=!1;try{const n=A(e.g,this,m,()=>{p=!0});n instanceof y&&"StopPropagation"===n.name&&(t=!0)}catch(n){console.error(n)}p||(m.result=
k.apply(this,l));if(!t)try{A(e.h,this,m)}catch(n){console.error(n)}return m.result}},set:function(k){k={u:b,value:k};if(!d.g){let l=!1;try{A(e.i,this,k,()=>{l=!0})}catch(m){console.error(m)}if(l)return!0}return g.call(this,k.value)}})}}var Jc=class{constructor(a,c){var b=CanvasRenderingContext2D.prototype;this.h=a;this.g=c;a=Object.getOwnPropertyNames(b);for(const d of a)Ic(this,b,d)}};function Kc(a){const c=HTMLCanvasElement.prototype.getContext,b=new WeakMap;HTMLCanvasElement.prototype.getContext=function(d){const e=c.apply(this,Array.from(arguments));if("2d"!==d||!(e instanceof CanvasRenderingContext2D))return e;const f=b.get(e)||Fc(new Gc(e,a.h,a.j));b.set(e,f);return f}}var Lc=class extends D{constructor(){var a=Cc();super();this.j=new Hc;this.h=a;Kc(this);new Jc(this.j,this.h)}};function Mc(a,c){const b=Math.max(a.start,c.start);a=Math.min(a.end,c.end);return b<=a?{start:b,end:a}:null};function Nc(a,c){let b=0;for(const [d,e]of c){const f=a.h.get(d);f&&f.G.start===e.G.start&&f.G.end===e.G.end&&f.zIndex===e.zIndex&&f.ka===e.ka&&f.backgroundColor===e.backgroundColor&&f.borderLeftWidth===e.borderLeftWidth&&f.borderLeftColor===e.borderLeftColor&&f.borderTopWidth===e.borderTopWidth&&f.borderTopColor===e.borderTopColor&&f.borderRightWidth===e.borderRightWidth&&f.borderRightColor===e.borderRightColor&&f.borderBottomWidth===e.borderBottomWidth&&f.borderBottomColor===e.borderBottomColor||
(b++,a.h.set(d,e))}0<b&&(a.g=null,A(a.l,c),A(a.i))}function Oc(a){null===a.g&&(a.g=Array.from(a.h).sort((c,b)=>{c="number"===typeof c[1].zIndex?c[1].zIndex:0;b="number"===typeof b[1].zIndex?b[1].zIndex:0;return c>b?1:c<b?-1:0}));return a.g}function*Pc(a,c){for(const [b,d]of Oc(a)){a=d.G;if(c&&(a=Mc(c,d.G),!a||a.start===a.end))continue;yield{id:b,ha:d,G:a}}}var Qc=class{constructor(){this.i=new C;this.l=new C;this.j=new C;this.h=new Map;this.g=null}};var Rc=class extends D{constructor(){var a=Cc();super();this.h=new C;this.j=new WeakMap;this.m=new Map;this.l=a;this.o=this.C.bind(this);this.s=this.H.bind(this);this.l.h.add(this.o);this.l.i.add(this.s)}g(){super.g();this.l.h.remove(this.o);this.l.i.remove(this.s)}C(a,c){if(!1!==this.m.get(a)&&0!==c.u.toString().indexOf("get")&&0!==c.u.toString().indexOf("measure")){c={type:"call",u:c.u,A:c.A};A(this.h,a,c);var b=this.j.get(a)||[];for(b.push(c);10<b.length;)b.shift();this.j.set(a,b)}}H(a,c){if(!1!==
this.m.get(a)){c={type:"set",u:c.u,value:c.value};A(this.h,a,c);var b=this.j.get(a)||[];for(b.push(c);10<b.length;)b.shift();this.j.set(a,b)}}};function T(){const a=[];var c=Array.from(document.getElementsByClassName("kix-canvas-tile-content")).sort((b,d)=>{b=parseFloat(b.style.top);d=parseFloat(d.style.top);return isFinite(b)&&isFinite(d)?b-d:0});for(const b of c)"CANVAS"===b.tagName&&(c=Sc.get(b))&&a.push(c);return a}var Sc=new WeakMap;function U(a,c){const b=Math.max(a.left,c.left),d=Math.min(a.left+a.width,c.left+c.width);if(b>d)return null;const e=Math.max(a.top,c.top);a=Math.min(a.top+a.height,c.top+c.height);return e>a?null:{left:b,top:e,width:d-b,height:a-e}}function Tc(a){return new Uc(a.left,a.top,a.width,a.height)}
function Vc(a,c){var b=U(a,c);if(null===b)return[a];c=a.left;const d=a.top,e=a.width;a=a.height;const f=b.left-c,g=b.top-d,h=f+b.width;b=g+b.height;return[0<f?{left:c,top:d,width:f,height:a}:null,0<g?{left:c,top:d,width:e,height:g}:null,h<e?{left:c+h,top:d,width:e-h,height:a}:null,b<a?{left:c,top:d+b,width:e,height:a-b}:null].filter(k=>null!==k)}var Uc=class{constructor(a,c,b,d){this.left=a;this.top=c;this.width=b;this.height=d}};const Wc=()=>({transform:{v:1,I:0,J:0,d:1,e:0,D:0},fillStyle:"",font:"",clip:null});function Xc(a,c){var b=a.h.get(c);return b&&0!==b.length?b[b.length-1]:(b=Wc(),a.h.set(c,[b]),b)}
var Yc=class extends D{constructor(a){super();this.h=new WeakMap;this.l=a;this.j=(c,b)=>{{const e=Xc(this,c);if("set"===b.type)"font"===b.u?e.font=b.value:"fillStyle"===b.u&&(e.fillStyle=b.value);else{if("save"===b.u){{var d={transform:{v:e.transform.v,I:e.transform.I,J:e.transform.J,d:e.transform.d,e:e.transform.e,D:e.transform.D},fillStyle:e.fillStyle,font:e.font,clip:e.clip};let f=this.h.get(c);f&&0!==f.length||(f=[Wc()],this.h.set(c,f));f.push(d)}}"restore"===b.u&&(d=this.h.get(c))&&0!==d.length&&
d.pop();"resetTransform"===b.u&&(e.transform={v:1,I:0,J:0,d:1,e:0,D:0});if("setTransform"===b.u)if(1===b.A.length)[c]=b.A,e.transform={v:c.v,I:c.I,J:c.J,d:c.d,e:c.e,D:c.D};else{const [f,g,h,k,l,m]=b.A;e.transform={v:f,I:g,J:h,d:k,e:l,D:m}}else if("transform"===b.u){const [f,g,h,k,l,m]=b.A;e.transform={v:e.transform.v*f,I:e.transform.I+g,J:e.transform.J+h,d:e.transform.d*k,e:e.transform.e+l*e.transform.v,D:e.transform.D+m*e.transform.d}}else if("translate"===b.u){const [f,g]=b.A;e.transform={v:e.transform.v,
I:e.transform.I,J:e.transform.J,d:e.transform.d,e:e.transform.e+f*e.transform.v,D:e.transform.D+g*e.transform.d}}else if("scale"===b.u){const [f,g]=b.A;e.transform={v:e.transform.v*f,I:e.transform.I,J:e.transform.J,d:e.transform.d*g,e:e.transform.e,D:e.transform.D}}else"clip"===b.u&&0===b.A.length&&(b=Array.from(this.l.j.get(c)||[]),2>b.length||(c=b[b.length-1],b=b[b.length-2],"call"===c.type&&"call"===b.type&&"rect"===c.u&&"beginPath"===b.u&&(c={left:c.A[0]*e.transform.v+e.transform.e,top:c.A[1]*
e.transform.d+e.transform.D,width:c.A[2]*e.transform.v,height:c.A[3]*e.transform.d},e.clip&&(b=U(Tc(c),e.clip),null!==b&&(c=b)),e.clip=c)))}}};a.h.add(this.j)}g(){super.g();this.l.h.remove(this.j)}};var Zc=class{constructor(a){this.g=new Map;this.h=a}};function $c(a,c){if(!a.g.has(c)){var b=c.canvas;const {canvas:d,context:e}=ad(a,b.width,b.height),{canvas:f,context:g}=bd(a,b.width,b.height);b=cd();b.za.appendChild(f);a.g.set(c,{va:d,da:e,Ja:f,F:g,pa:b.element});b=()=>{var h=c.canvas;const k=h.getAttribute("style")||"",l=h.width;h=h.height;f.setAttribute("style",k);f.width=l;f.height=h;f.style.position="absolute";d instanceof HTMLCanvasElement&&d.setAttribute("style",k);d.width=l;d.height=h};(new MutationObserver(b)).observe(c.canvas,{attributes:!0,
attributeFilter:["width","height","style"]});f.classList.add("wizkids-overlay-canvas");b()}return a.g.get(c)}
function dd(a,c){var b,d,e,f,g;const h=[],k=[];for(const {Ea:p,ha:t}of c)for(const n of p){c=n.left;const r=n.top,q=n.width,v=n.height;for(var l=0;l<h.length;l++){const u=h[l];var m=Vc(u.rect,{left:c,top:u.rect.top,width:q,height:u.rect.height});0===m.length?(h.splice(l,1),l--):1===m.length?u.rect=m[0]:(m=m.map(w=>({rect:w,color:u.color})),h.splice(l,1,...m),l+=m.length-1)}h.push({rect:{left:c,top:r,width:q,height:v},color:null!==(b=t.ka)&&void 0!==b?b:a.fillStyle||"#000000"});t.backgroundColor&&
k.push({fillStyle:t.backgroundColor,rect:{left:c,top:r,width:q,height:v}});t.borderTopColor&&(l=null!==(d=t.borderTopWidth)&&void 0!==d?d:1,k.push({fillStyle:t.borderTopColor,rect:{left:c,top:r-l,width:q,height:l}}));t.borderLeftColor&&(l=null!==(e=t.borderLeftWidth)&&void 0!==e?e:1,k.push({fillStyle:t.borderLeftColor,rect:{left:c-l,top:r,width:l,height:v}}));t.borderBottomColor&&(l=null!==(f=t.borderBottomWidth)&&void 0!==f?f:1,k.push({fillStyle:t.borderBottomColor,rect:{left:c,top:r+v,width:q,height:l}}));
t.borderRightColor&&(l=null!==(g=t.borderRightWidth)&&void 0!==g?g:1,k.push({fillStyle:t.borderRightColor,rect:{left:c+q,top:r,width:l,height:v}}))}return{Ga:h,Aa:k}}function bd(a,c,b){const d=document.createElement("canvas");d.width=c;d.height=b;c=d.getContext("2d");a.h.m.set(c,!1);return{canvas:d,context:c}}function ad(a,c,b){if("undefined"===typeof OffscreenCanvas)return bd(a,c,b);a=new OffscreenCanvas(c,b);c=a.getContext("2d");return{canvas:a,context:c}}
function cd(){const a=document.createElement("div");a.className="wizkids-overlay-canvas-container";return{element:a,za:a}}var ed=class{constructor(a){this.g=new WeakMap;this.h=a;this.h.h.add((c,b)=>{c=$c(this,c);"set"===b.type?Reflect.set(c.da,b.u,b.value):"call"===b.type&&"fillText"!==b.u&&Reflect.get(c.da,b.u).apply(c.da,b.A)})}clear(a,c={left:-1E8,top:-1E8,width:2E8,height:2E8}){$c(this,a).F.clearRect(c.left,c.top,c.width,c.height)}};function fd(a){var c=Performance.prototype;const b=c.now;c.now=function(...d){let e=0;try{e=a(this,...d)}catch(f){console.error(f)}if(1!==e)return b.apply(this,d)};return()=>{c.now=b}}function gd(a){const c=T();for(const b of c)hd(a,b);a.l=!1;a.m++}
function hd(a,c){a.o.clear(c);var b=a.j.get(c);if(b)for(const k of b){b=a;var d=c,e=k;if(e.data){var f=e.data.S(),g={fillStyle:e.fillStyle,font:e.font,text:e.text,x:e.position.left,y:e.position.top,transform:e.transform},h=[];for(const {ha:l,G:m}of Pc(b.H,f))f=e.data.L(m),0!==f.length&&h.push({Ea:f,ha:l});if(0!==h.length){{b=$c(b.o,d);b.pa.parentNode||d.canvas.after(b.pa);const {Ga:l,Aa:m}=dd(g,h);try{b.F.save();b.F.setTransform(g.transform.v,g.transform.I,g.transform.J,g.transform.d,g.transform.e,
g.transform.D);b.F.font=g.font;for(const {rect:p}of l)1E-5>Math.abs(p.width)||1E-5>Math.abs(p.height)||(b.F.fillStyle="#ffffff",b.F.fillRect(p.left,p.top,p.width,p.height),b.F.drawImage(b.va,p.left*g.transform.v+g.transform.e,p.top*g.transform.d+g.transform.D,p.width*g.transform.v,p.height*g.transform.d,p.left,p.top,p.width,p.height));for(const {rect:p,fillStyle:t}of m)1E-5>Math.abs(p.width)||1E-5>Math.abs(p.height)||(b.F.fillStyle=t,b.F.fillRect(p.left,p.top,p.width,p.height));for(const {rect:p,
color:t}of l)if(!(1E-5>Math.abs(p.width)||1E-5>Math.abs(p.height)))try{b.F.save();const n=new Path2D;n.rect(p.left,p.top,p.width,p.height);b.F.clip(n);b.F.fillStyle=t;b.F.fillText(g.text,g.x,g.y)}finally{b.F.restore()}}finally{b.F.restore()}}}}}}
var id=class extends D{constructor(a,c){super();this.l=!1;this.h=null;this.m=0;this.j=new WeakMap;this.H=a;this.o=new ed(c);this.s=new Yc(c);const b=(new OffscreenCanvas(1,1)).getContext("2d");if(!b)throw Error("Failed to create offscreen context");this.C=new Zc(b);const d=()=>gd(this);a.i.add(d);this.i.add(()=>a.i.remove(d));const e=new WeakMap,f=new WeakMap,g=(h,k)=>{if("set"!==k.type){var l=k.u;k=k.A;try{if(Sc.has(h.canvas)||Sc.set(h.canvas,h),"clearRect"===l||"fillRect"===l){const [Ea,Fa,H,ka]=
k;f.set(h,0);var m=this.j.get(h);if(m){var p=Xc(this.s,h),t=Tc({left:Ea*p.transform.v+p.transform.e,top:Fa*p.transform.d+p.transform.D,width:H*p.transform.v,height:ka*p.transform.d});if(p.clip){const G=U(t,p.clip);null===G?t=null:t=Tc(G)}if(null!==t){var n=[];for(const G of m){const I=U(t,G.rect);null!==I&&0<I.width&&I.height>G.rect.height/2?this.h&&this.h.C(h,G):n.push(G)}this.j.set(h,n)}}}else if("fillText"===l){this.l=!0;this.j.has(h)||this.j.set(h,[]);n=this.j.get(h);const [Ea,Fa]=[k[1],k[2]],
H=Xc(this.s,h),ka=f.get(h);m={left:Ea,top:Fa};var r=this.m,q=k[0];{t=m;var v=H.transform;a:{var u=this.C,w=k[0],B=H.font;k=`${B}:${w}`;const Cb=u.g.get(k);if(void 0!==Cb)var z=Cb;else{var K=u.h;try{K.save();K.font=B;const Db=B.match(/([\d.]+)px/),Eb={width:K.measureText(w).width,height:Db?parseFloat(Db[1]):12};u.g.set(k,Eb);z=Eb;break a}finally{K.restore()}z=void 0}}const {width:I,height:Id}=z;var Jd={width:I*v.v,height:Id*v.d,left:t.left*v.v+v.e,top:t.top*v.d+v.D}}const G={Ia:r,data:null,kind:void 0===
ka?0:ka,text:q,position:m,rect:Jd,font:H.font,fillStyle:H.fillStyle,transform:H.transform};if(H.clip){const I=U(Tc(G.rect),H.clip);if(null===I||0===I.width||0===I.height){this.h&&this.h.B(h);return}}this.h&&this.h.o(h,G);n.push(G)}else"translate"===l||"save"===l?"restore"===e.get(h)&&f.set(h,0):"setLineDash"===l&&"save"===e.get(h)&&f.set(h,1)}finally{e.set(h,l)}}};c.h.add(g);this.i.add(()=>c.h.remove(g));this.i.add(fd(()=>{if(this.l){this.h&&this.h.s();{const h=T();for(const k of h)hd(this,k);this.l=
!1;this.m++}}}))}};function jd(a,c){for(const b of a.h)if(b.na===c)return b}
var kd=class extends D{constructor(){super(...arguments);this.h=[]}g(){super.g();this.clear()}add(a,c){let b=jd(this,a);void 0===b&&(b={na:a,T:[]},this.h.push(b));-1===b.T.indexOf(c)&&(b.T.push(c),a.add(c))}remove(a,c){const b=jd(this,a);void 0!==b&&(b.T.splice(b.T.indexOf(c),1),a.remove(c),0===b.T.length&&(a=jd(this,a),void 0!==a&&(a=this.h.indexOf(a),-1!==a&&this.h.splice(a,1))))}clear(){for(const a of this.h)for(const c of a.T)a.na.remove(c);this.h=[]}};function ld(a,c){a.i=Object.assign(Object.assign({},a.i),c)}function md(a,c){a.g=c;a.h.clear();c&&a.h.add(c.s,b=>A(a.j,b));A(a.l)}var nd=class{constructor(){this.l=new C;this.j=new C;this.i={ja:!0};this.h=new kd;this.g=null}Z(){return this.g}L(a){return this.g?this.g.L(a):[]}};function od(a,c){var b=0;const d=[];for(;;){b=a.indexOf(c,b);if(-1===b)break;d.push(b);b+=1}return d};function pd(a){let c=0;for(let b=0;b<a.h.length-1;b++){const d=a.g[b],e=a.g[b+1],f=a.i.filter(h=>d<h&&h<e),g=e-d;c+=a.h[b+1].start-a.h[b].end;c+=-50*f.length;c+=10*(g-1)}return c+=-50*(a.g.length-1)}function qd(a){return a.h.reduce((c,b)=>Math.max(c,b.end),0)}function rd(a){const c=new sd(a.i);c.g=a.g.slice();c.h=a.h.map(b=>({start:b.start,end:b.end}));c.K=a.K;return c}class sd{constructor(a){this.K=0;this.g=[];this.h=[];this.i=a}add(a,c){this.g.push(a);this.h.push(c);this.K=pd(this)}}
function td(a){return 0===a.length?a:"\u202d"===a[0]&&"\u202c"===a[a.length-1]||"\u202e"===a[0]&&"\u202c"===a[a.length-1]?a.substring(1,a.length-1):a}function ud(a){let c="",b=a.length;for(let d=0;d<b;d++){if(55349!==a.charCodeAt(d)||d===b-1){c+=a[d];continue}const e=a.charCodeAt(d+1);56398>e||56449<e?c+=a[d]:(c+=String.fromCharCode(e-56398+97),d++)}return c}
function vd(a,c,b){let d=[];const e=b.reduce((h,k,l)=>{0!==k.kind&&h.push(l);return h},[]);for(let h=0;h<b.length;h++){var f=b[h];let k=td(f.text);a.g&&(k=ud(k));if(0===f.kind){f=od(c,k);var g=Array.from(d);for(const l of g){if(l.g.includes(h))continue;const m=qd(l);g=f.reduce((t,n)=>n<m?t:null===t?n:t>n?n:t,null);if(null==g)continue;const p=rd(l);p.add(h,{start:g,end:g+k.length});d.push(p)}for(const l of f)f=new sd(e),f.add(h,{start:l,end:l+k.length}),d.push(f);3<h&&(d=d.sort((l,m)=>{const p=m.g.length-
l.g.length;return 0!==p?p:l.K-m.K}).slice(0,5))}}return wd(a,c,b,d).sort((h,k)=>{const l=k.g.length-h.g.length;return 0!==l?l:h.K-k.K}).slice(0,5)}
function wd(a,c,b,d){for(const f of d){for(let g=0;g<f.g.length-1;g++){const h=f.g[g],k=f.g[g+1]-h;if(1>=k)continue;var e=f.h[g].end;const l=c.substring(e,f.h[g+1].start);let m=0;for(let p=1;p<k;p++){const t=h+p;let n=td(b[t].text);a.g&&(n=ud(n));const r=l.indexOf(n,m);-1!==r&&(m=r+n.length,f.g.splice(g+1,0,t),f.h.splice(g+1,0,{start:e+r,end:e+r+n.length}),g++)}}f.K=pd(f)}return d}
var xd=class{constructor(){var a={Da:!1},c;this.g=null!==(c=null===a||void 0===a?void 0:a.Da)&&void 0!==c?c:!1}match(a,c){var b=od(a,"\u0003");if(0===b.length)return[];const d=b.map((g,h,k)=>{g+=1;h=k.length-1===h?a.length:k[h+1];return{start:g,end:h,text:a.substring(g,h)}});b=vd(this,d[0].text,c).reduce((g,h)=>{const k=h.g.length,l=g.get(k)||[];l.push(h);g.set(k,l);return g},new Map);var e=Array.from(b.keys()).reduce((g,h)=>Math.max(g,h),0);b=b.get(e)||[];if(0===b.length)return c.map(()=>null);e=
b.map((g,h)=>({index:h,K:g.K})).sort((g,h)=>g.K-h.K);const f=b[e[0].index];return c.map((g,h)=>{g=f.g.indexOf(h);return-1===g?null:{start:f.h[g].start+d[0].start,end:f.h[g].end+d[0].start}})}};function yd(){const a={};a.promise=new Promise((c,b)=>{a.g=c;a.h=b});return a};function zd(a){var c;window.clearTimeout(a.j);const b=null!==(c=a.g)&&void 0!==c?c:yd();a.j=window.setTimeout(()=>{a.i=Date.now();a.g=null;a.h();b.g()},0);return b.promise}var Ad=class{constructor(a){this.g=this.i=null;this.h=a}};function Bd(a){x(a,function*(){yield zd(this.g)})}var Cd=class{constructor(){this.g=new Ad(()=>{document.dispatchEvent(new CustomEvent("webkitvisibilitychange",{cancelable:!1,bubbles:!1}));document.dispatchEvent(new CustomEvent("focus",{cancelable:!1,bubbles:!0}))})}};var Dd=class{constructor(a,c){this.m=new C;this.O=new Cd;this.l=[];this.g=new Map;this.h=[];this.H=new OffscreenCanvas(0,0);this.i=this.H.getContext("2d");this.M=a;this.j=c;Bd(this.O)}C(a,c){this.h.includes(a)||this.h.push(a);const b=this.g.get(a);b?(a=b.N.indexOf(c),b.N.splice(a,1),b.items.splice(a,1),b.R=a,c.data&&this.j.remove(c.data.S())):this.g.set(a,{N:[],items:[],R:null})}o(a,c){this.h.includes(a)||this.h.push(a);var b=Ma(c.text);b={text:b,kind:1===c.kind||td(b).match(/^(([a-zA-Z0-9]\.)+|[\w\W])$/)?
1:0};const d=this.g.get(a);d?null!==d.R?(d.N.splice(d.R,0,c),d.items.splice(d.R,0,b),d.R++):(d.N.push(c),d.items.push(b)):this.g.set(a,{N:[c],items:[b],R:null})}B(){}s(){let a=!1;for(const c of this.h){const b=this.g.get(c);if(!b)continue;b.R=null;const d=(new xd).match(Hb(this.M),b.items);for(let e=0;e<b.N.length;e++){const f=b.N[e],g=d[e];if(!g){f.data=null;continue}a=!0;const h={start:g.start,end:g.end};this.l.push(h);this.j.add(g);this.j.add(h);A(this.m,{start:g.start,end:g.end});f.data={S:()=>
g,Ba:()=>g,L:k=>{if(k.start===k.end)return[];var l=k.start-g.start;const m=td(f.text);var p=m.substring(0,l);k=m.substring(l,Math.min(k.end-g.start,g.end-g.start));this.i.font=f.font;this.i.fillStyle=f.fillStyle;k=this.i.measureText(k).width;l=(l=f.font.match(/([0-9\.]+)px/))?parseFloat(l[1]):12;p=this.i.measureText(p).width;return[{left:"ltr"===(m.match(/[\u0591-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]+/)?"rtl":"ltr")?f.position.left+p:f.position.left+this.i.measureText(m).width-p-k,top:f.position.top-
l-.5,width:k,height:1.2*l}]}}}}this.h=[];a&&za(this.l,c=>{this.j.remove(c)})}L(a){const c=[];var b=T();for(const e of b){var d=this.g.get(e);if(d){b=e.canvas.getBoundingClientRect();for(const f of d.N)if(f.data&&(d=f.data.S(),(d=Mc(a,d))&&d.start!==d.end)){d=f.data.L(d);for(const g of d)c.push({left:g.left*f.transform.v+b.left,top:g.top*f.transform.d+b.top,width:g.width*f.transform.v,height:g.height*f.transform.d})}}}return c}},Ed=class extends D{constructor(a,c){super();this.s=new C;this.j=new kd;
this.h=new Dd(a,c);this.j.add(this.h.m,b=>A(this.s,b))}g(){this.j.M()}O(){return this.h}W(){{var a=this.h;var c=T();const b=[];for(const d of c)if(c=a.g.get(d))for(const e of c.N)e.data&&(c=e.data.S(),b.push({start:c.start,end:c.end}));za(b);a=b}return a}V(){return this.h.l}L(a){return this.h.L(a)}};function Fd(a){const c=(b,d)=>{try{a.U(),b()}catch(e){"complete"===document.readyState?d(e):setTimeout(()=>{c(b,d)},100)}};return new Promise((b,d)=>{c(b,d)})};function Gd(a,c){a=Array.from(a.g.keys());let b=0;for(const d of c){c=d[0];const e=d[1].length;if("insert"===c){for(const f of a)f.start>=b&&(f.start+=e),f.end>=b&&(f.end+=e);b+=e}else if("delete"===c)for(const f of a)f.start>=b&&(f.start=Math.max(f.start-e,b)),f.end>=b&&(f.end=Math.max(f.end-e,b));else b+=e}}var Hd=class{constructor(){this.g=Ca()?new $b:new lc}add(a){this.g.set(a,!0)}remove(a){this.g.delete(a)}};function V(a,c){return a.C(a,c)}function Kd(a){if(a.h&&a.i){var c=a.h.o.indexOf(a);-1!==c&&(a.h.o.splice(c,1),a.h=null,a.i=null)}}
function W(a,c){if(a.h&&a.i)return W(a.h,{start:a.i.start+c.start,end:a.i.start+c.end});var b=a.g.join("").length;c={start:Math.min(Math.max(c.start,0),b),end:Math.min(Math.max(c.end,0),b)};b=new Ld(d=>{let e=0;const f=d.h;d=d.i;f&&d&&(e=Md(f,{start:0,end:d.start}));return a.l(a)+e},(d,e)=>{const f=d.g.join("").length;let g=0;const h=d.h;d=d.i;h&&d&&(g=Md(h,{start:0,end:d.start}));return V(a,{start:g+Math.min(Math.max(e.start,0),f),end:g+Math.min(Math.max(e.end,0),f)})});b.B=a.B;b.g=a.g.slice(c.start,
c.end);b.j=a.j.slice(c.start,c.end);b.m=a.m.slice(c.start,c.end);b.h=a;b.i=c;a.o.push(b);return b}function Md(a,c){return a.g.slice(c.start,c.end).join("").length}function Nd(a,c){if(!a.h||!a.i)return!1;const b=a.h,d=a.i;d.end=Math.min(d.end+c,b.g.length);a.g=b.g.slice(d.start,d.end);a.j=b.j.slice(d.start,d.end);a.m=b.m.slice(d.start,d.end);return!0}
var Ld=class{constructor(a,c){this.g=[];this.m=[];this.j=[];this.B=!1;this.o=[];this.i=this.h=null;this.l=a;this.C=c}get s(){if(!this.h)return null;const a=this.h.o.indexOf(this);return-1===a||0===a?null:this.h.o[a-1]}};var Od=class{g(a,c,b,d){let e=0;for(var f of c)c=d.g.indexOf(f,e),-1!==c&&(e=c+1);f=W(d,{start:0,end:e});d=W(d,{start:e,end:d.g.length});0<d.g.length&&b.unshift(d);a(f);return 0}};var Pd=class{g(a,c,b,d){var e=d.g.join("").indexOf(c);if(-1===e&&d.s)return Nd(d.s,d.g.length),Kd(d),1;if(-1!==e){{var f=d.g;c=e+c.length;let h=0,k=null,l=0;for(let m=0;m<f.length;m++){{var g=Math.max(e,l);const p=Math.min(c,l+f[m].length);g=g<=p?{start:g,end:p}:null}if(g&&g.start!==g.end)null===k&&(k=m),h++;else if(null!==k)break;l+=f[m].length}e=null===k?{start:0,end:h}:{start:k,end:k+h}}0<e.start&&(f=d.s,f&&Nd(f,e.start)||(e.start=0));if(0===e.end-e.start)return 0;a(W(d,e));e.end!==d.g.length&&
b.unshift(W(d,{start:e.end,end:d.g.length}));Kd(d)}return 0}};function Qd(a,c){return[c[0]*a.a+c[1]*a.c+a.e,c[0]*a.b+c[1]*a.d+a.f]};var X=Symbol.for("@wizkids/FingerprintOriginalFunction");function*Y(a){for(const c in a){const b=Object.getOwnPropertyDescriptor(a,c);if(b&&b.value)try{const d=X in b.value?b.value[X]:null;yield{key:c,value:d?d.value:b.value}}catch(d){}}};var Rd=class{g(){const a=/function(?: [a-zA-Z0-9$_]+)?\([a-zA-Z0-9$_,]*\){(|this\.[a-zA-Z0-9$_]+=(.*?))/;var c=window;for(const {value:b}of Y(c))if("function"===typeof b&&b.toString().match(a)&&"prototype"in b){c=b.prototype;for(const {key:d,value:e}of Y(c)){const f=e.toString();if(f.match(/function(?: [a-zA-Z0-9$_]+)?\(a,b\){[\w\W]+b\.getData\(\);[\w\W]+[a-zA-Z0-9$_\[\]\.]+(,[a-zA-Z0-9$_\[\]\.]+){3,}\)/)&&f.includes("execute"))return[{parent:c,key:d,value:e}]}}return[]}};function Sd(a){const c=a.j.g();if(0===c.length)return!1;for(const {parent:b,key:d,value:e}of c){X in b[d]||(b[d]=function(){const h={callFunction:e,context:this,args:Array.from(arguments),result:void 0};for(var k of b[d][X].onBeforeCall)try{k(h)}catch(l){console.error(l)}k=b[d][X].value.apply(this,h.args);h.result=k;for(const l of b[d][X].onAfterCall)try{l(h)}catch(m){console.error(m)}return h.result},b[d][X]={},b[d][X].value=e,b[d][X].onBeforeCall=[],b[d][X].onAfterCall=[],b[d][X].uninstallIfEmpty=
()=>{0<b[d][X].onBeforeCall.length||0<b[d][X].onAfterCall.length||(b[d]=b[d][X].value)});const f=h=>{const k={context:h.context,A:h.args,wa:h.callFunction};A(a.i,k);h.args=k.A},g=h=>{const k={context:h.context,A:h.args,result:h.result,wa:h.callFunction};A(a.h,k);h.result=k.result};b[d][X].onBeforeCall.push(f);b[d][X].onAfterCall.push(g);a.g.push(()=>{const h=b[d][X].onBeforeCall.indexOf(f);-1!==h&&b[d][X].onBeforeCall.splice(h,1)});a.g.push(()=>{const h=b[d][X].onAfterCall.indexOf(g);-1!==h&&b[d][X].onAfterCall.splice(h,
1)});a.g.push(()=>b[d][X].uninstallIfEmpty())}return!0}function Td(a){for(const c of a.g)c();a.g=[]}var Ud=class{constructor(a){this.i=new C;this.h=new C;this.g=[];this.j=a}};var Vd=class{constructor(){this.g=new Map}get(a,c){if(!this.g.has(a)){c=c();if(!c)return null;this.g.set(a,c)}return this.g.get(a)}clear(){this.g.clear()}};var Wd=class{g(){const a=[],c=window;for(const {key:b,value:d}of Y(c)){if("function"!==typeof d)continue;const e=d.toString();e.match(/^function(?: [a-zA-Z0-9$_]+)?\(a,b,c,d,e\){return function\(\){a\.get\(\)\.([a-zA-Z0-9$_]+)\(/)&&(e.match(/scale|transform|rotate|translate/)||a.push({parent:c,key:b,value:d}))}return a}};var Xd=class{g(){const a=[];var c=window;for(const {value:b}of Y(c))if(b&&"function"===typeof b&&"prototype"in b){c=b.prototype;for(const {key:d,value:e}of Y(c)){if("function"!==typeof e)continue;const f=e.toString(),g=f.match(/\.execute\(/g);g&&2<=g.length?a.push({key:d,parent:c,value:e}):f.includes(".getHeight()")&&f.includes(".save()")&&f.includes(".restore()")&&f.includes(".clear()")&&f.includes(".next()")&&f.includes(".done")&&a.push({key:d,parent:c,value:e})}}return a}};class Yd{constructor(a){this.g=new WeakMap;this.h=new WeakMap;this.i=Ca()?new $b:new lc;this.j=a}clear(a){this.g.delete(a)}push(a,c){const b=this.g.get(a);b?b.push(c):this.g.set(a,[c])}s(){}C(a,c){this.i.delete(c);if(c.data&&(a=this.h.get(a))){var b=a.get(c);b&&this.j.remove(b);a.delete(c)}}B(a){(a=this.g.get(a))&&a.shift()}o(a,c){var b=this.g.get(a);b&&(b=b.shift())&&(c.data=b,b=c.data.S(),this.h.has(a)||this.h.set(a,new Map),this.j.add(b),this.h.get(a).set(c,b),this.i.set(c,b))}}let Zd=0;
function $d(a,{A:c}){(()=>{A(a.ua);var [,b]=c;const d=b.getData();if(d[dc]){d[ec]!==Zd&&(b=(()=>{for(const {key:k,value:l}of Y(d))if("object"===typeof l&&!Array.isArray(l)&&"execute"in l)return k;return null})(),null!==b&&(d[b]=null),d[ec]=Zd);b=a.h.splice(0,a.h.length);for(var e of b)e.s&&(Nd(e.s,e.g.length),Kd(e));if(e=a.$.get("textDataPath",()=>{a:{for(l in d){var k=d[l];if(Array.isArray(k)&&0!==k.length){k=k[0];for(const m in k)if(!Array.isArray(k[m]))break a}}var l=null}return l})){e=d[e];b=
!1;if(1<e.length){var f=e[0];for(var g in d)if(f===d[g]){b=!0;break}}if(0!==e.length){g=null;f=0;for(let k=0;k<e.length;k++){const l=e[k];if((()=>{for(const r in d)if(d[r]===l)return!0;return!1})())continue;var h=La(l);if(!h)break;const m=h.sa,p=h.ta;h=h.oa;const t=f,n=()=>{var r=d[ac]+t;const q=d[cc];if(!q)return r;for(const {type:v,index:u,length:w}of q.ea)r<u||("insert"===v?r+=w:"delete"===v&&(r=Math.max(r-w,u)));return r};g||(g=new Ld(n,(r,q)=>d[dc](q)),g.B=b,a.h.push(g));g.g=g.g.concat(m);g.m=
g.m.concat(p);g.j=g.j.concat(h);f+=m.join("").length}}}}else a.j=new WeakMap})();(()=>{var [,b]=c;b=b.getData();if(!a.j.get(b))for(const d in b)if("string"===typeof b[d]){b[d]={};a.j.set(b,!0);break}})()}function ae(a,{A:c}){if(!a.ca.ja){a=c[0].slice();const b=a.indexOf("spelling-error");-1!==b&&a.splice(b,1);c[0]=a}}
function be(a,{context:c}){if(!a.j.get(c))for(const b of Object.keys(c.constructor.prototype)){const d=c[b];if("function"===typeof d&&d.toString().match(/delete this\./)){a.j.set(a,!0);c[b]("text-foreground");break}}}
function ce(a,c,b,d,e,f,g){let h=null;Array.isArray(d)?d=d.map(k=>Ma(k)):d=Ma(d);try{const k=()=>{const l=a.h.shift();l&&(l&&l.B?(l.B=!1,a.h.unshift(l)):1===(Array.isArray(d)?new Od:new Pd).g(m=>h=m,d,a.h,l)&&k())};k()}catch(k){console.error(k)}return function(){let k=0;try{if(null!==h&&!a.B){var l=()=>{let m=[];var p=Cc(),t=(n,r,q)=>{if("fillText"===r.u){var [v,u,w]=r.A;m.push({text:v,x:u,y:w});q();return new y}};p.g.add(t,{priority:1E3});try{c.apply(this,arguments)}catch(n){console.error(n)}p.g.remove(t);
t=p=0;Array.isArray(d)?(p=m.map(n=>n.x),t=m.map(n=>n.y)):0<m.length&&(p=m[0].x,t=m[0].y);return{x:p,y:t}};if(Array.isArray(d)&&Array.isArray(e)&&Array.isArray(f)&&Array.isArray(g)){const {x:m,y:p}=l();l=[];for(let t=0;t<e.length;t++)l.push({text:d[t],x:e[t],y:f[t],qa:m[t],ia:p[t],width:g[t]});k=de(a,h,b,l)}else if(!(Array.isArray(d)||Array.isArray(e)||Array.isArray(f)||Array.isArray(g))){const {x:m,y:p}=l();k=de(a,h,b,{x:e,y:f,qa:m,ia:p,width:g,text:d})}}}catch(m){console.error(m)}if(0===k)return c.apply(this,
arguments)}}
function de(a,c,b,d){const e=(()=>{const q=b.get();for(const v in q){if(q[v]instanceof CanvasRenderingContext2D)return q[v];if("object"===typeof q[v])for(const u in q[v])if(q[v][u]instanceof CanvasRenderingContext2D)return q[v][u]}return null})();if(!e)return 0;var f=c.g.join("");const g=c.l(c),h=f.length;A(a.s,{start:g,end:g+h});const k=Array.isArray(d)?0:f.indexOf(d.text),l=(()=>{if(Array.isArray(d)||0===c.g.length||-1===k)return 0;let q=d.qa;if(0<k){const v=V(c,{start:0,end:k}),u=V(c,{start:k,
end:k+1});0<u.length&&(q-=u[0].left-(v?v[0].left:0))}return q-=Math.min(...c.j)})(),m=(()=>Array.isArray(d)?d.map(q=>q.ia).reduce((q,v)=>Math.max(q,v),0):d.ia)(),[p,t]=Qd(e.getTransform(),[l,m]);f=a.m.get(e)||[];f.push({Fa:c,position:{left:p,top:t}});a.m.set(e,f);f=Array.isArray(d)?d:[d];const n=f.reduce((q,v,u)=>{u=c.g.join("").indexOf(v.text,0===u?0:q[u-1].end-g);-1===u&&(console.warn("Couldn't find fillText call in list of fill texts"),u=0);q.push({start:g+u,end:g+u+v.text.length});return q},[]),
r=n.reduce((q,v,u,w)=>{q.push({start:0===u?g:q[u-1].end,end:u<w.length-1?w[u+1].start:g+h});return q},[]);for(let q=0;q<f.length;q++){const v=()=>{const u=c.l(c);return{start:r[q].start+(u-g),end:r[q].end+(u-g)}};a.l.push(e,{Ba:()=>{const u=c.l(c);return{start:n[q].start+(u-g),end:n[q].end+(u-g)}},S:v,L:u=>{var w=v(),B=Math.min(Math.max(u.start,w.start),w.end);u=Math.min(Math.max(u.end,w.start),w.end);w=c.l(c);B={start:Math.max(B-w,0),end:Math.max(u-w,0)};return B.start===B.end?[]:V(c,B).map(z=>({left:z.left+
l,top:m-z.height,width:z.width,height:1.2*z.height}))}})}return 0}
var ee=class extends D{constructor(a){super();this.s=new C;this.ua=new C;this.aa=new Cd;this.m=new WeakMap;this.ca={ja:!0};this.$=new Vd;this.h=[];this.j=new WeakMap;this.H=new Ud(new Rd);this.C=new Ud(new Wd);this.o=new Ud(new Xd);this.l=new Yd(a);Cc().g.add((c,b)=>{if("clearRect"===b.u||"fillRect"===b.u){var [d,e,f,g]=b.A;if(-1E8===d&&-1E8===e&&2E8===f&&2E8===g||0===d&&0===e&&f===c.canvas.width&&g===c.canvas.height)this.m.delete(c),this.l.clear(c)}});this.H.i.add(c=>$d(this,c));this.C.h.add(c=>
{{const b=c.A;if("string"===typeof b[1]||Array.isArray(b[1])){const [d,e,f,g,h]=b;c.result=ce(this,c.result,d,e,f,g,h)}}});this.o.i.add(c=>ae(this,c));this.o.h.add(c=>be(this,c))}g(){super.g();Td(this.H);Td(this.C);Td(this.o)}V(){{var a=this.l;const c=[];for(const b of a.i.values())c.push({start:b.start,end:b.end});za(c);a=c}return a}W(){{var a=this.l;var c=T();const b=[];for(const d of c)if(c=a.h.get(d))for(const e of c.values())b.push({start:e.start,end:e.end});za(b);a=b}return a}L(a){const c=[];
var b=T();for(const e of b){b=this.m.get(e)||[];for(const {Fa:f,position:g}of b){var d=f.l(f);b=e.canvas.getBoundingClientRect();d={start:Math.max(a.start-d,0),end:Math.max(a.end-d,0)};if(d.start!==d.end){d=V(f,d);for(const h of d)c.push({left:h.left+g.left+b.left,top:g.top-h.height+b.top,width:h.width,height:1.2*h.height})}}}return c}O(){return this.l}U(){if(!Sd(this.H))throw Error("Unable to install text renderer!");if(!Sd(this.C))throw Error("Unable to install renderer!");if(!Sd(this.o))throw Error("Unable to install render queue executor!");
Zd++;Bd(this.aa)}};function fe(a){if(!a.B){const c=eb();a.B=c;c.W.add(d=>{R("__onSelectionChange",zc(d))});c.V.add(d=>{R("__onEquationBarVisibilityChange",d)});c.$.add(()=>{R("__onSpellCheckChange",{})});let b;c.aa.add((d,e)=>{var f=S(new Yb,e,d);Gd(a.s,f);e=0;for(const g of f)switch(f=g[1].length,g[0]){case "insert":mc(a.m,e,f);e+=f;break;case "delete":nc(a.m,e,f);break;case "equal":e+=f}a.i=()=>({paragraphStarts:zb(c),text:d});window.clearTimeout(b);b=window.setTimeout(()=>ge(a))})}return a.B}
function ge(a){if(a.i){window.clearTimeout(a.M);var c=a.i();a.i=null;R("__onTextChange",c);gd(a.l)}}function he(a){return x(a,function*(){yield ie(this);yield je(this);ke(this)})}
function le(){var a=new me;x(a,function*(){ba(this.C,c=>{a:{if(c.detail&&"string"===typeof c.detail){try{var b=JSON.parse(c.detail,ua)}catch(f){console.error(f);var d=void 0;break a}if("object"===typeof b&&"string"===typeof b.id&&"string"===typeof b.type&&Array.isArray(b.args)){c=b.id;var e=b.type;b=b.args;try{d=ne(this,e,b),R(c,d)}catch(f){f instanceof Error?ya(c,f):ya(c,Error(f+""))}}}d=void 0}return d});new Lc;yield he(this);R("__onInitialized",{status:"SUCCESS"})})}
function ie(a){return x(a,function*(){yield Fd(this.m)})}function je(a){return x(a,function*(){const c=b=>{try{pb(fe(this)),b()}catch(d){window.setTimeout(()=>c(b),50)}};return new Promise(b=>{c(b)})})}
function ke(a){x(a,function*(){yield Z(this,"default");console.log(`Active renderer: ${this.g}`);let c=this.g;oe()&&(yield Z(this,"fallback"));(()=>x(this,function*(){for(;;){try{oe()?"fallback"!==this.g&&(c=this.g,yield Z(this,"fallback"),console.log(`Active renderer: ${this.g}`)):yield Z(this,c)}catch(b){console.error(b)}yield new Promise(b=>window.setTimeout(b,2E3))}}))()})}
function pe(a){return x(a,function*(){const c=this.g;c in this.j&&(yield Z(this,this.j[c].ga),console.log(`Active renderer: ${this.g}`))})}function Z(a,c){return x(a,function*(){if(this.g!==c){var b=this.h,d=b.Z();d&&(md(b,null),this.l.h=null,d.i.clear(),d.M());if(c in this.j){d=this.j[c];try{const e=yield d.Z();e.i.add(()=>pe(this));md(b,e);this.l.h=e.O();this.g=c}catch(e){console.error(e),Z(this,d.ga)}}else this.g=c}})}
function oe(){const a=document.querySelector("canvas.kix-canvas-tile-content");return a&&a.parentElement?!a.parentElement.classList.contains("kix-page-paginated"):!1}
function qe(a,c){c=c.map(([b,d])=>[b,{G:{start:d.range.start,end:d.range.end},zIndex:d.zIndex,backgroundColor:d.backgroundColor,borderLeftWidth:d.borderLeftWidth,borderLeftColor:d.borderLeftColor,borderTopWidth:d.borderTopWidth,borderTopColor:d.borderTopColor,borderRightWidth:d.borderRightWidth,borderRightColor:d.borderRightColor,borderBottomWidth:d.borderBottomWidth,borderBottomColor:d.borderBottomColor,ka:d.textColor}]);Nc(a.o,c)}
function re(a,c){a=a.o;for(const b of c)a.h.delete(b);a.g=null;A(a.j,c);A(a.i)}
function ne(a,c,b){var d=fe(a);switch(c){case "HvW5":return zc(d.getSelection());case "AurK":return d=wb(d,b[0],b[1]),Ac(d);case "wnZK":return Hb(d);case "fXY1":return d.ca(b[0],b[1]);case "gO78":a=xc(b[0]);if(null===a)throw Error("Unable to decode json for location!");return Fb(d,a);case "N+aV":return zb(d);case "2u1z":return Jb(d,b[0]);case "zvZQ":return qe(a,b[0]);case "L81W":return re(a,b[0]);case "ppV+":return se(a,
0<b.length?b[0]:void 0);case "kQIP":return a.h.L(yc(b[0])).map(e=>({left:e.left,top:e.top,width:e.width,height:e.height}));case "149D":ld(a.h,{ja:b[0]});return;case "2SZD":return Array.from(Ab(fe(a)).entries()).map(e=>[e[0],Ac(e[1])]);case "aBmO":Z(a,b[0]);return;case "YP+n":return a.g;case "wdbv":return ab(d.m).map(e=>Bc(e));case "6cLn":return d=bb(d.m,b[0]),null===d?null:Bc(d);case "K37Y":return d=cb(d.m,b[0],
b[1]),null===d?null:Bc(d);case "H6uf":return qe(a,[[b[0],b[1]]]);case "32eB":return re(a,[b[0]]);case "Myjb":return{text:"",data:[],positionedObjects:[]};case "kew8":return;case "HhSa":return[]}throw Error(`Unknown type ${c}!`);}function se(a,c=!1){return(a=a.h.Z())?c?a.W():a.V():[]}
var me=class{constructor(){this.C=new ca;this.g="none";this.j={["default"]:{Z:()=>x(this,function*(){const a=new ee(this.s);yield Fd(a);return a}),ga:"fallback"},["fallback"]:{Z:()=>x(this,function*(){return new Ed(fe(this),this.s)}),ga:"none"}};this.m=new wc;this.h=new nd;this.o=new Qc;this.H=new Rc;this.l=new id(this.o,this.H);this.s=new Hd;this.i=null;this.h.j.add(a=>{ge(this);R("__onTextRendered",{start:a.start,end:a.end})})}};const te=compiler.VERSION;(function(){return x(this,function*(){const a=window;if("wizkids-google-docs-integration"in a)a["wizkids-google-docs-integration"]!==te&&console.warn("Wizkids Google Docs integration version mismatch!");else{a["wizkids-google-docs-integration"]=te;try{le()}catch(c){console.error(c)}}})})();})();
